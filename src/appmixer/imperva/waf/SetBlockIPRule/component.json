{
    "version": "1.0.0",
    "name": "appmixer.imperva.waf.SetBlockIPRule",
    "label": "Block IPs",
    "author": "Appmixer <info@appmixer.com>",
    "description": "Blocks a list of IP addresses by adding a blocking custom rule to the WAF (using RULE_ACTION_BLOCK action).",
    "private": false,
    "auth": {
        "service": "appmixer:imperva"
    },
    "quota": {},
    "inPorts": [
        {
            "name": "in",
            "schema": {
                "type": "object",
                "properties": {
                    "siteId": {
                         "type": "number"
                    },
                    "ips": {
                        "type": "string"
                    },
                    "ttl": {
                        "type": "integer"
                    }
                },
                "required": ["siteId", "ips", "ttl"]
            },
            "inspector": {
                "inputs": {
                    "siteId": {
                        "type": "select",
                        "index": 0,
                        "label": "Site ID",
                        "source": {
                            "url": "/component/appmixer/imperva/waf/ListSites?outPort=out",
                            "data": {
                                "messages": {
                                    "in/isSource": true
                                },
                                "transform": "./ListSites#toSelectArray"
                            }
                        }
                    },
                    "ips": {
                        "type": "textarea",
                        "index": 1,
                        "label": "IPs",
                        "tooltip": "List of IP address which will be blocked by adding a blocking custom rule to the waf. The values must be separated by a comma, space or newline."
                    },
                    "ttl": {
                        "type": "number",
                        "index": 2,
                        "label": "TTL",
                        "tooltip": "Time to live in seconds. The rule will be automatically removed after this time."
                    }
                }
            }
        }
    ],
    "outPorts": [
        {
            "name": "out",
            "options": [
                {
                    "label": "Site ID",
                    "value": "siteId",
                    "schema": {
                        "type": "string"
                    }
                },
                {
                    "label": "IPs",
                    "value": "ips",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                {
                    "label": "Rules",
                    "value": "rules",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "rule_id": {
                                    "type": "string"
                                },
                                "name": {
                                    "type": "string"
                                },
                                "action": {
                                    "type": "string"
                                },
                                "filter": {
                                    "type": "string"
                                },
                                "sendNotifications": {
                                    "type": "boolean"
                                }
                            }
                        }
                    }
                }
            ]
        }
    ],
    "properties": {},
    "icon": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM1IiBoZWlnaHQ9IjM3IiB2aWV3Qm94PSIwIDAgMTM1IDM3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMuNDg2MyAwLjA3MDMxMjVINi4yMzgyMlY1LjU3NDE2SDAuNzM0Mzc1VjAuMDcwMzEyNUgzLjQ4NjNaTTEzMi4yMDYgMzAuNTc0M0gxMzQuOTU4VjM2LjA3ODFIMTI5LjQ1NFYzMC41NzQzSDEzMi4yMDZaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTM4LjEzNzUgMTUuMDcxM0MzOC4xMzc1IDEwLjU3NTIgMzUuNjk1NiA3Ljc0NTc5IDMxLjYyNTkgNy43NDU3OUMyOC44MzUyIDcuNzQ1NzkgMjYuOTM2IDguODMxMDYgMjUuNjU2OSAxMC4yMjY0QzI0LjU3MTcgOC43NTM1NCAyMi43MTEyIDcuNzA3MDMgMjAuMzQ2OSA3LjcwNzAzQzE4LjEzNzYgNy43MDcwMyAxNi4zMTU5IDguNTU5NzQgMTUuMzQ2OSA5LjgwMDA0VjguMTcyMTRIOS44NDMwNVYyNy45NzgySDE1LjMwODFWMTUuMjI2NEMxNS42NTcgMTMuNTU5NyAxNi45NzQ4IDEyLjY2ODIgMTguNDA4OSAxMi42NjgyQzIwLjMwODEgMTIuNjY4MiAyMS4xOTk2IDE0LjA2MzYgMjEuMTk5NiAxNi4xOTU0VjI3Ljk3ODJIMjYuNzQyMlYxNS4yMjY0QzI3LjA5MSAxMy41NTk3IDI4LjM3MDEgMTIuNjY4MiAyOS44MDQyIDEyLjY2ODJDMzEuNzAzNCAxMi42NjgyIDMyLjYzMzYgMTQuMDYzNiAzMi42MzM2IDE2LjE5NTRWMjcuOTc4MkgzOC4xMzc1VjE1LjA3MTNaTTAuNzM0Mzc1IDI3Ljk3OEg2LjIzODIyVjguMTcxODhIMy40ODYzSDAuNzM0Mzc1VjI3Ljk3OFpNNDcuMTY4MyAzNi4wNzlINDEuNjY0NVY4LjE3MjE0SDQ3LjE2ODNWOS44MDAwNEM0OC4wNTk4IDguNzUzNTQgNDkuOTk3OCA3LjcwNzAzIDUyLjEyOTUgNy43MDcwM0M1Ny45MDQ3IDcuNzA3MDMgNjEuMTYwNSAxMi40NzQ0IDYxLjE2MDUgMTguMDU1OEM2MS4xNjA1IDIzLjYzNzIgNTcuODY1OSAyOC4zNjU4IDUyLjEyOTUgMjguMzY1OEM0OS45OTc4IDI4LjM2NTggNDguMDU5OCAyNy4zNTgxIDQ3LjE2ODMgMjYuMjcyOFYzNi4wNzlaTTUwLjg4OTEgMjMuNjM3QzQ5LjI5OTkgMjMuNjM3IDQ3LjgyNzEgMjIuNzA2NyA0Ny4xNjgyIDIxLjM1MDJWMTQuNzk5OEM0Ny44MjcxIDEzLjQ4MiA0OS4yNjEyIDEyLjUxMyA1MC44ODkxIDEyLjUxM0M1My44MzQ4IDEyLjUxMyA1NS42MTc3IDE0LjkxNjEgNTUuNjE3NyAxOC4wOTQ0QzU1LjYxNzcgMjEuMjMzOSA1My44NzM1IDIzLjYzNyA1MC44ODkxIDIzLjYzN1pNNzQuMjIyOCAyMy45MDgzQzcxLjMyNzUgMjMuOTA4MyA2OC45NzA2IDIyLjU2MjYgNjguNTMwNCAxOS4zNzM0SDgxLjIzODNWMTcuNTkwNUM4MS4yMzgzIDExLjczNzggNzguMjkyNSA3Ljc0NTU4IDcyLjUxNzQgNy43NDU1OEM2Ny4xMjk4IDcuNzQ1NTggNjMuMjE1MSAxMi4wNDc5IDYzLjIxNTEgMTguMjQ5NEM2My4yMTUxIDI0LjUyODQgNjcuMzYyNCAyOC40NDMxIDczLjM3MDEgMjguNDQzMUM3Ni4wNDQ1IDI4LjQ0MzEgNzguMjUzOCAyNy45MDA1IDc5Ljg4MTcgMjYuNjk5VjIyLjE2NDFDNzcuOTQzNyAyMy40MDQ0IDc2LjM5MzMgMjMuOTA4MyA3NC4yMjI4IDIzLjkwODNaTTc2LjE5ODUgMTUuNzY4N0g2OC43MThDNjkuMzM4MSAxMy4yODgxIDcwLjg4ODUgMTIuMTI1MyA3Mi43MTAyIDEyLjEyNTNDNzQuODgwNyAxMi4xMjUzIDc2LjA4MjMgMTMuNjM2OSA3Ni4xOTg1IDE1Ljc2ODdaTTk2LjIzODEgMTMuNTk4NUM5NS41MDE3IDEzLjE3MjEgOTQuNDkzOSAxMi45Mzk2IDkzLjQ4NjIgMTIuOTM5NkM5MS42MjU3IDEyLjkzOTYgOTAuMTE0MSAxMy45MDg1IDg5LjcyNjUgMTUuNzMwMlYyNy45NzgySDg0LjIyMjdWOC4xNzIxNEg4OS43MjY1VjEwLjExMDFDOTAuNTc5MiA4LjY3NjAyIDkyLjIwNzEgNy43MDcwMyA5NC4xNDUxIDcuNzA3MDNDOTUuMDc1MyA3LjcwNzAzIDk1LjkyOCA3LjkwMDgzIDk2LjIzODEgOC4wNTU4N1YxMy41OTg1Wk05Ny4zMjMzIDguMTcxODhMMTA0LjgwNCAyNy45NzhIMTEwLjExNEwxMTcuNjMzIDguMTcxODhIMTEyLjA5MUwxMDcuNjMzIDIxLjMxMTNMMTAzLjA2IDguMTcxODhIOTcuMzIzM1pNMTI5LjQ5MyAxNS42MTM2QzEyOS40OTMgMTMuNzE0NCAxMjcuODY1IDEyLjUxMjggMTI1LjA3NCAxMi41MTI4QzEyMy4wOTcgMTIuNTEyOCAxMjEuMjM3IDEzLjA5NDIgMTE5LjY4NiAxNC4xMDJWOS4zNzMzM0MxMjEuMTIxIDguNDgxODYgMTIzLjY3OSA3Ljc0NTQzIDEyNi4yNzYgNy43NDU0M0MxMzEuNzQxIDcuNzQ1NDMgMTM0Ljk5NiAxMC41MzYxIDEzNC45OTYgMTUuMzgxVjI3Ljk3NzlIMTI5LjQ5M1YyNi45MzE0QzEyOC44MzQgMjcuNTkwMyAxMjYuODk2IDI4LjM2NTUgMTI0LjcyNSAyOC4zNjU1QzEyMC43MzMgMjguMzY1NSAxMTcuNCAyNi4wNzg3IDExNy40IDIxLjkzMTRDMTE3LjQgMTguMTcxNyAxMjAuNzMzIDE1LjYxMzYgMTI1LjA3NCAxNS42MTM2QzEyNi44MTggMTUuNjEzNiAxMjguNzE3IDE2LjE5NSAxMjkuNDkzIDE2Ljc3NjRWMTUuNjEzNlpNMTI2LjAwNSAxOS40MTI2QzEyNy41NTUgMTkuNDEyNiAxMjguOTkgMjAuMTEwMyAxMjkuNDkzIDIxLjE1NjhWMjIuNTUyMUMxMjkuMDI4IDIzLjYzNzQgMTI3LjU1NSAyNC4yOTYzIDEyNi4wMDUgMjQuMjk2M0MxMjQuMyAyNC4yOTYzIDEyMi41MTcgMjMuNTk4NiAxMjIuNTE3IDIxLjg1NDVDMTIyLjUxNyAyMC4xNDkgMTI0LjI2MSAxOS40MTI2IDEyNi4wMDUgMTkuNDEyNloiIGZpbGw9ImJsYWNrIi8+Cjwvc3ZnPgo="
}
