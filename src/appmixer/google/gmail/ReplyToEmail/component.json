{
    "name": "appmixer.google.gmail.ReplyToEmail",
    "author": "Sayam Nasir <sayam@client.io>",
    "description": "Send a reply to an existing email",
    "version": "1.0.1",
    "auth": {
        "service": "appmixer:google",
        "scope": [
            "https://www.googleapis.com/auth/gmail.compose",
            "https://www.googleapis.com/auth/gmail.send",
            "https://www.googleapis.com/auth/gmail.modify"
        ]
    },
    "quota": {
        "manager": "appmixer:google:gmail",
        "maxWait": 5000,
        "resources": "messages.send",
        "scope": {
            "userId": "{{userId}}"
        }
    },
    "inPorts": [
        {
            "name": "in",
            "inspector": {
                "inputs": {
                    "email": {
                        "type": "text",
                        "label": "Email",
                        "index": 1,
                        "tooltip": "Select an Email to reply",
                        "source": { 
                            "url": "/component/appmixer/google/gmail/ListEmails?outPort=out",
                            "data": {
                                "messages": {
                                    "in/limit": "20",
                                    "in/outputType": "emails"
                                },
                                "properties": {
                                    "sendWholeArray": true,
                                    "variableFetch": true
                                },
                                "transform": "./ListEmails#emailsToSelectArray"
                            }
                        }
                    },
                    "from": {
                        "type": "text",
                        "index": 2,
                        "label": "From",
                        "tooltip": "The email address that you have authenticated with or one of your valid aliases. Anything else will be ignored and will default to your primary email address."
                    },
                    "sender": {
                        "type": "text",
                        "index": 3,
                        "label": "From Name",
                        "tooltip": "The name of the author of the message. This won't work if you have invalid email address in the From field."
                    },
                    "to": {
                        "type": "text",
                        "index": 4,
                        "label": "To",
                        "tooltip": "The email address of the message's recipient."
                    },
                    "cc": {
                        "type": "text",
                        "index": 5,
                        "label": "CC",
                        "tooltip": "The email address of the message's carbon copy recipient."
                    },
                    "bcc": {
                        "type": "text",
                        "index": 6,
                        "label": "BCC",
                        "tooltip": "The email address of the message's blind carbon copy recipient."
                    },
                    "text": {
                        "type": "textarea",
                        "index": 8,
                        "label": "Text",
                        "tooltip": "The body of the message. If HTML Body is added, This text body will be ignored. If Signature is added and HTML body field is left blank This Text Body will be converted into HTML"
                    },
                    "html": {
                        "type": "textarea",
                        "index": 9,
                        "label": "HTML",
                        "tooltip": "HTML body of the message. If HTML body is added, the Text Body of the email is ignored"
                    },
                    "signature": {
                        "type": "text",
                        "label": "Signature",
                        "index": 10,
                        "tooltip": "Add signature to the email.",
                        "source": { 
                            "url": "/component/appmixer/google/gmail/ListSignatures?outPort=out",
                            "data": {
                                "properties": { "sendWholeArray": true },
                                "transform": "./ListSignatures#signaturesToSelectArray"
                            }
                        }
                    },
                    "labels": {
                        "type": "expression",
                        "label": "Labels",
                        "levels": [
                            "AND"
                        ],
                        "index": 11,
                        "tooltip": "Add labels to the email.",
                        "fields": {
                            "name": {
                                "type": "select",
                                "label": "Name",
                                "index": 1,
                                "tooltip": "Select a name of the existing label.",
                                "source": { 
                                    "url": "/component/appmixer/google/gmail/ListLabels?outPort=out",
                                    "data": {
                                        "properties": { "sendWholeArray": true },
                                        "transform": "./ListLabels#labelsToSelectArrayFiltered"
                                    }
                                }
                            }
                        }
                    },
                    "attachments": {
                        "type": "expression",
                        "label": "Attachments",
                        "tooltip": "Attachments for the email message.",
                        "index": 11,
                        "levels": [ "ADD" ],
                        "fields": {
                            "fileId": {
                                "type": "filepicker",
                                "label": "File",
                                "tooltip": "The file to attach.",
                                "index": 1
                            }
                        }
                    }
                }
            },
            "schema": {
                "type": "object",
                "properties": {
                    "email": {
                        "type": "string"
                    },
                    "from": {
                        "type": "string",
                        "format": "email"
                    },
                    "sender": {
                        "type": "string"
                    },
                    "to": {
                        "type": "string",
                        "format": "email"
                    },
                    "cc": {
                        "type": "string",
                        "format": "email"
                    },
                    "bcc": {
                        "type": "string",
                        "format": "email"
                    },
                    "text": {
                        "type": "string"
                    },
                    "html": {
                        "type": "string"
                    },
                    "signature":{
                        "type": "string"
                    },
                    "labels": {
                        "type": "object"
                    },
                    "attachments": {}
                },
                "required": [
                    "to"
                ]
            }
        }
    ],
    "outPorts": [
        {
            "name": "out",
            "options": [
                { "label": "id", "value": "id" },
                { "label": "threadId", "value": "threadId" }
            ]
        }
    ],
    "icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBpZD0iR3JvdXBfNTQ1IiBkYXRhLW5hbWU9Ikdyb3VwIDU0NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM3NiAtNjQpIj4KICAgIDxyZWN0IGlkPSJSZWN0YW5nbGVfMzMyNyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMzMyNyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNzYgNjQpIiBmaWxsPSJub25lIi8+CiAgICA8ZyBpZD0iR3JvdXBfNTQ0IiBkYXRhLW5hbWU9Ikdyb3VwIDU0NCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDM5OCA3MjIzLjAxNikiPgogICAgICA8cGF0aCBpZD0iUGF0aF8xNzIiIGRhdGEtbmFtZT0iUGF0aCAxNzIiIGQ9Ik01My4zNjQsNzAuMTM2aDMuMTgyVjYyLjQwOUw1Miw1OXY5Ljc3M0ExLjM2MywxLjM2MywwLDAsMCw1My4zNjQsNzAuMTM2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQwNzIgLTcyMTAuMTQ5KSIgZmlsbD0iIzQyODVmNCIvPgogICAgICA8cGF0aCBpZD0iUGF0aF8xNzMiIGRhdGEtbmFtZT0iUGF0aCAxNzMiIGQ9Ik0xMjAsNzAuMTM2aDMuMTgyYTEuMzYzLDEuMzYzLDAsMCwwLDEuMzY0LTEuMzY0VjU5TDEyMCw2Mi40MDlaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDEyNC41NDUgLTcyMTAuMTQ5KSIgZmlsbD0iIzM0YTg1MyIvPgogICAgICA8cGF0aCBpZD0iUGF0aF8xNzQiIGRhdGEtbmFtZT0iUGF0aCAxNzQiIGQ9Ik0xMjAsNDMuMzUxVjQ5LjI2bDQuNTQ2LTMuNDA5VjQ0LjAzM2EyLjA0NSwyLjA0NSwwLDAsMC0zLjI3My0xLjYzNloiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00MTI0LjU0NSAtNzE5NykiIGZpbGw9IiNmYmJjMDQiLz4KICAgICAgPHBhdGggaWQ9IlBhdGhfMTc1IiBkYXRhLW5hbWU9IlBhdGggMTc1IiBkPSJNNzIsNTMuOTA5VjQ4bDUuNDU1LDQuMDkxTDgyLjkwOSw0OHY1LjkwOUw3Ny40NTUsNThaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDA4Ny40NTUgLTcyMDEuNjQ5KSIgZmlsbD0iI2VhNDMzNSIgZmlsbC1ydWxlPSJldmVub2RkIi8+CiAgICAgIDxwYXRoIGlkPSJQYXRoXzE3NiIgZGF0YS1uYW1lPSJQYXRoIDE3NiIgZD0iTTUyLDQ0LjAzM3YxLjgxOGw0LjU0NSwzLjQwOVY0My4zNTFMNTUuMjczLDQyLjRBMi4wNDUsMi4wNDUsMCwwLDAsNTIsNDQuMDMzWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQwNzIgLTcxOTcpIiBmaWxsPSIjYzUyMjFmIi8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"
}
