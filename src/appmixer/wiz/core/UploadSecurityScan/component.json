{
    "name": "appmixer.wiz.core.UploadSecurityScan",
    "author": "Appmixer <info@appmixer.com>",
    "description": "TBD",
    "private": false,
    "auth": {
        "service": "appmixer:wiz"
    },
    "quota": {
        "manager": "appmixer:wiz",
        "resources": "requests"
    },
    "version": "1.0.0",
    "inPorts": [
        {
            "name": "in",
            "schema": {
                "type": "object",
                "properties": {
                    "integrationId": {
                        "type": "string"
                    },
                    "dataSourceId": {
                        "type": "string"
                    },
                    "cloudPlatform": {
                        "type": "string"
                    },
                    "providerId": {
                        "type": "string"
                    },
                    "vulnerabilityFindings": {
                        "type": "array"
                    }
                },
                "required": [
                    "integrationId",
                    "dataSourceId",
                    "cloudPlatform",
                    "providerId",
                    "vulnerabilityFindings"
                ]
            },
            "inspector": {
                "inputs": {
                    "integrationId": {
                        "type": "text",
                        "label": "Integration ID",
                        "tooltip": "The unique ID for each Wiz integration. Sent by Wiz during the integration initiation process.",
                        "index": 0
                    },
                    "dataSourceId": {
                        "type": "text",
                        "label": "Data Source ID",
                        "tooltip": "The ID that uniquely identifies asset findings within a tenant and integration ID. Can be a subscription ID.",
                        "index": 1
                    },
                    "providerId": {
                        "type": "text",
                        "label": "Provider ID",
                        "tooltip": "A unique identifier assigned to a specific cloud asset by the cloud service provider when the asset is created, allowing for the identification and differentiation of the asset within the cloud computing ecosystem. ARN—AWS, Resource group—Azure.",
                        "index": 2
                    },
                    "cloudPlatform": {
                        "type": "select",
                        "index": 2,
                        "label": "Cloud Platform",
                        "defaultValue": "AWS",
                        "tooltip": "The cloud platform that was scanned. Default is AWS",
                        "options": [
                            { "label": "AWS", "value": "AWS" },
                            { "label": "Azure", "value": "Azure" },
                            { "label": "GCP", "value": "GCP" },
                            { "label": "OCI", "value": "OCI" },
                            { "label": "Alibaba Cloud", "value": "Alibaba Cloud" },
                            { "label": "Linode", "value": "Linode" }
                        ]
                    },
                    "vulnerabilityFindings": {
                        "type": "expression",
                        "index": 2,
                        "label": "Has an error in it",
                        "levels": ["AND"],
                        "fields": {
                            "id": {
                                "type": "text",
                                "index": 1,
                                "label": "Vulnerability ID",
                                "tooltip": "The unique ID of the discovered vulnerability finding.",
                                "required": true
                            },
                            "name": {
                                "type": "text",
                                "index": 1,
                                "label": "Name",
                                "tooltip": "The name of the Vulnerability, for example CVE-2021-25288.",
                                "required": true
                            },
                            "severity": {
                                "type": "select",
                                "index": 2,
                                "label": "Severity",
                                "defaultValue": "Medium",
                                "tooltip": "The severity of the vulnerability. Default is Medium",
                                "required": true,
                                "options": [
                                    { "label": "None", "value": "None" },
                                    { "label": "Low", "value": "Low" },
                                    { "label": "Medium", "value": "Medium" },
                                    { "label": "High", "value": "High" }
                                ]
                            },
                            "externalDetectionSource": {
                                "type": "select",
                                "index": 2,
                                "label": "Severity",
                                "defaultValue": "Medium",
                                "tooltip": "The severity of the vulnerability. Default is Medium",
                                "required": true,
                                "options": [
                                    { "label": "Package", "value": "Package" },
                                    { "label": "Default Package", "value": "Default Package" },
                                    { "label": "Library", "value": "Library" },
                                    { "label": "Operating System", ",value": "Operating System" },
                                    { "label": "Installed Program (Windows)", "value": "Installed Program (Windows)" },
                                    {
                                        "label": "Installed Program By Service (Windows)",
                                        "value": "Installed Program By Service (Windows)"
                                    },
                                    { "label": "File Path", "value": "File Path" }
                                ]
                            },
                            "externalFindingLink": {
                                "type": "text",
                                "index": 1,
                                "label": "External Finding Link",
                                "tooltip": "A link to the source of the external finding."
                            },
                            "detailsName": {
                                "type": "text",
                                "index": 1,
                                "label": "Details Name",
                                "tooltip": "The details of the externalDetectionSource, such as \"Package,\" should include relevant information about the package. For instance, if the externalDetectionSource is \"libncurses6,\" the \"Details Name\" should reflect details about the package, such as \"libncurses6 package.\"."
                            },
                            "version": {
                                "type": "text",
                                "index": 1,
                                "label": "Version",
                                "tooltip": "The version of the finding."
                            },
                            "description": {
                                "type": "text",
                                "index": 1,
                                "label": "Description",
                                "tooltip": "A description of the finding."
                            },
                            "sourceName": {
                                "type": "text",
                                "index": 1,
                                "label": "Source Name",
                                "tooltip": "The name of the product that detected the vulnerability."
                            },
                            "remediation": {
                                "type": "text",
                                "index": 1,
                                "label": "Remediation",
                                "tooltip": "The remediation for the vulnerability."
                            },
                            "validatedInRuntime": {
                                "type": "toggle",
                                "index": 1,
                                "label": "Validated In Runtime",
                                "defaultValue": false,
                                "tooltip": "Indicates if the finding was detected during runtime (true), or if it was detected during offline or static scanning (false)."
                            }
                        }
                    },
                    "filename": {
                        "type": "text",
                        "label": "File Name",
                        "index": 0
                    },
                    "fileContent": {
                        "type": "textarea",
                        "index": 1,
                        "label": "File Content",
                        "tooltip": "Specify the file content in JSON format <b>(Ignored if 'File ID' is set)</b>."
                    }
                }
            }
        }
    ],
    "outPorts": [
        {
            "name": "out"
        }
    ],
    "icon": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIGlkPSJMYXllcl8yIiBkYXRhLW5hbWU9IkxheWVyIDIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDE1Mi42NiA2NS4wNSI+PGRlZnM+PHN0eWxlPi5jbHMtMSB7CiAgICAgICAgZmlsbDogIzAwNDZkMTsKICAgICAgICBzdHJva2Utd2lkdGg6IDBweDsKICAgICAgfTwvc3R5bGU+PC9kZWZzPjxnIGlkPSJMYXllcl8zIiBkYXRhLW5hbWU9IkxheWVyIDMiPjxnPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0ibTE1Mi40OSw4LjczYy0xLjcxLS4zMS00LjU5LTEuMDMtNi4wOC0yLjUydi4wMmMtMS40Ny0xLjQ4LTIuMjQtNC4zNi0yLjU2LTYuMDYtLjA2LS4yNC0uNC0uMjQtLjQ0LDAtLjMxLDEuNzEtMS4wNCw0LjU5LTIuNTIsNi4wOC0xLjQ4LDEuNDctNC4zNiwyLjI0LTYuMDYsMi41Ni0uMjQuMDYtLjI0LjQsMCwuNDQsMS43MS4zMSw0LjU5LDEuMDQsNi4wOCwyLjUyLDEuNjksMS42OCwyLjM2LDQuMTIsMi42Miw1LjcyLjA0LjI0LjQuMjQuNDQsMCwuMzUtMS43MywxLjA4LTQuMzcsMi40Ni01Ljc2LDEuNDgtMS40Nyw0LjM2LTIuMjQsNi4wNi0yLjU2LjI0LS4wNi4yNC0uNCwwLS40NFoiLz48cmVjdCBjbGFzcz0iY2xzLTEiIHg9IjY2Ljg3IiB5PSIxOC41NCIgd2lkdGg9IjExLjM4IiBoZWlnaHQ9IjQ2LjQ5IiByeD0iLjY3IiByeT0iLjY3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtLjE1IC4yNikgcm90YXRlKC0uMjEpIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJtODkuOTYsMTguODhjMC0uNTQuNDUtLjkxLjgzLS42N2wuMDItLjAyLDMyLjE1LDIxLjE4Yy4zOC4yNy44My0uMS44My0uNjdsLS4wNy0xOS45MmMwLS40OS4yOC0uODYuNjQtLjg2bDkuMzMtLjAzYy4zNiwwLC42NC4zOS42NS44NmwuMTYsNDQuODZjMCwuNTctLjQ3Ljk0LS44NS42N2wtMzMuMDItMjMuNjRjLS4zOC0uMjctLjg1LjEtLjg1LjY3bC4wOCwyMi44NWMwLC40OS0uMjguODYtLjY0Ljg2bC04LjQ0LjAzYy0uMzYsMC0uNjQtLjM5LS42NS0uODZsLS4xNi00NS4zWiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0ibTQ4LjAxLDE4LjQzbDEwLjU1LS4wNGguMDJjLjQ4LDAsLjgxLjQ5LjY0LjkzbC0xNy4yOSw0NS40OGMtLjA4LjItLjM0LjItLjQ0LjAybC0xMC43MS0yMS4yNGMtLjIyLS40My0uNjYtLjY1LTEuMDctLjY1LS40NCwwLS44NS4yMi0xLjA3LjY2bC0xMC41NSwyMS4zMmMtLjEuMTgtLjM2LjE4LS40NC0uMDJMLjA0LDE5LjU0Yy0uMTYtLjQ2LjE2LS45My42My0uOTNsMTAuNTUtLjA0Yy4yOCwwLC41NC4xOC42NC40M2w3LjUxLDE5LjQzYy4wOC4xOC4zNi4yLjQ0LDBsOC43OS0xOS4zNWMuMi0uNDQuNjEtLjcsMS4wMy0uNy40Mi4wMi44MS4yNSwxLjAxLjY5bDguOTQsMTkuMjljLjA4LjIuMzYuMi40NCwwbDcuMzctMTkuNDhjLjEtLjI2LjM2LS40NC42My0uNDRaIi8+PC9nPjwvZz48L3N2Zz4="
}
