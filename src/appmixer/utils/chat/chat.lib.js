var chatbot=function(we){"use strict";/**
    @license
    
    DHTMLX Chatbot v.1.0.0
    
    This software is provided under the MIT license
    (c) XB Software
    
    **/
    function j(){}function ne(i,e){for(const t in e)i[t]=e[t];return i}function Be(i){return i()}function ze(){return Object.create(null)}function re(i){i.forEach(Be)}function ke(i){return typeof i=="function"}function O(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}let ye;function X(i,e){return i===e?!0:(ye||(ye=document.createElement("a")),ye.href=e,i===ye.href)}function Yt(i){return Object.keys(i).length===0}function Ut(i,...e){if(i==null){for(const n of e)n(void 0);return j}const t=i.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function $(i,e,t){i.$$.on_destroy.push(Ut(e,t))}function W(i,e,t,n){if(i){const l=Ve(i,e,t,n);return i[0](l)}}function Ve(i,e,t,n){return i[1]&&n?ne(t.ctx.slice(),i[1](n(e))):t.ctx}function Y(i,e,t,n){if(i[2]&&n){const l=i[2](n(t));if(e.dirty===void 0)return l;if(typeof l=="object"){const s=[],r=Math.max(e.dirty.length,l.length);for(let a=0;a<r;a+=1)s[a]=e.dirty[a]|l[a];return s}return e.dirty|l}return e.dirty}function U(i,e,t,n,l,s){if(l){const r=Ve(e,t,n,s);i.p(r,l)}}function Z(i){if(i.ctx.length>32){const e=[],t=i.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function ae(i){const e={};for(const t in i)t[0]!=="$"&&(e[t]=i[t]);return e}function Me(i){return i??""}function De(i){return i&&ke(i.destroy)?i.destroy:j}const Zt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function b(i,e){i.appendChild(e)}function k(i,e,t){i.insertBefore(e,t||null)}function p(i){i.parentNode&&i.parentNode.removeChild(i)}function Jt(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function _(i){return document.createElement(i)}function Gt(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function F(i){return document.createTextNode(i)}function A(){return F(" ")}function x(){return F("")}function ie(i,e,t,n){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t,n)}function m(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function Kt(i){return Array.from(i.childNodes)}function z(i,e){e=""+e,i.data!==e&&(i.data=e)}function We(i,e){i.value=e??""}function be(i,e,t,n){t==null?i.style.removeProperty(e):i.style.setProperty(e,t,"")}let Ce;function Qt(){if(Ce===void 0){Ce=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Ce=!0}}return Ce}function Xt(i,e){getComputedStyle(i).position==="static"&&(i.style.position="relative");const n=_("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const l=Qt();let s;return l?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=ie(window,"message",r=>{r.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{s=ie(n.contentWindow,"resize",e),e()}),b(i,n),()=>{(l||s&&n.contentWindow)&&s(),p(n)}}function B(i,e,t){i.classList.toggle(e,!!t)}function xt(i,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(i,{detail:e,bubbles:t,cancelable:n})}class Ye{is_svg=!1;e=void 0;n=void 0;t=void 0;a=void 0;constructor(e=!1){this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.is_svg?this.e=Gt(t.nodeName):this.e=_(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)k(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(p)}}function Se(i,e){return new i(e)}let ve;function pe(i){ve=i}function oe(){if(!ve)throw new Error("Function called outside component initialization");return ve}function Ee(i){oe().$$.on_mount.push(i)}function $t(i){oe().$$.after_update.push(i)}function en(i){oe().$$.on_destroy.push(i)}function fe(){const i=oe();return(e,t,{cancelable:n=!1}={})=>{const l=i.$$.callbacks[e];if(l){const s=xt(e,t,{cancelable:n});return l.slice().forEach(r=>{r.call(i,s)}),!s.defaultPrevented}return!0}}function Ue(i,e){return oe().$$.context.set(i,e),e}function je(i){return oe().$$.context.get(i)}function tn(i,e){const t=i.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const ce=[],ee=[];let ue=[];const Oe=[],nn=Promise.resolve();let Le=!1;function ln(){Le||(Le=!0,nn.then(Ze))}function Ne(i){ue.push(i)}function sn(i){Oe.push(i)}const Ie=new Set;let de=0;function Ze(){if(de!==0)return;const i=ve;do{try{for(;de<ce.length;){const e=ce[de];de++,pe(e),rn(e.$$)}}catch(e){throw ce.length=0,de=0,e}for(pe(null),ce.length=0,de=0;ee.length;)ee.pop()();for(let e=0;e<ue.length;e+=1){const t=ue[e];Ie.has(t)||(Ie.add(t),t())}ue.length=0}while(ce.length);for(;Oe.length;)Oe.pop()();Le=!1,Ie.clear(),pe(i)}function rn(i){if(i.fragment!==null){i.update(),re(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(Ne)}}function an(i){const e=[],t=[];ue.forEach(n=>i.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),ue=e}const Te=new Set;let le;function J(){le={r:0,c:[],p:le}}function G(){le.r||re(le.c),le=le.p}function w(i,e){i&&i.i&&(Te.delete(i),i.i(e))}function S(i,e,t,n){if(i&&i.o){if(Te.has(i))return;Te.add(i),le.c.push(()=>{Te.delete(i),n&&(t&&i.d(1),n())}),i.o(e)}else n&&n()}function te(i){return i?.length!==void 0?i:Array.from(i)}function Je(i,e){i.d(1),e.delete(i.key)}function on(i,e){S(i,1,1,()=>{e.delete(i.key)})}function qe(i,e,t,n,l,s,r,a,o,f,u,c){let d=i.length,h=s.length,g=d;const v={};for(;g--;)v[i[g].key]=g;const M=[],H=new Map,N=new Map,y=[];for(g=h;g--;){const P=c(l,s,g),K=t(P);let Q=r.get(K);Q?y.push(()=>Q.p(P,e)):(Q=f(K,P),Q.c()),H.set(K,M[g]=Q),K in v&&N.set(K,Math.abs(g-v[K]))}const C=new Set,R=new Set;function he(P){w(P,1),P.m(a,u),r.set(P.key,P),u=P.first,h--}for(;d&&h;){const P=M[h-1],K=i[d-1],Q=P.key,ge=K.key;P===K?(u=P.first,d--,h--):H.has(ge)?!r.has(Q)||C.has(Q)?he(P):R.has(ge)?d--:N.get(Q)>N.get(ge)?(R.add(Q),he(P)):(C.add(ge),d--):(o(K,r),d--)}for(;d--;){const P=i[d];H.has(P.key)||o(P,r)}for(;h;)he(M[h-1]);return re(y),M}function fn(i,e,t){const n=i.$$.props[e];n!==void 0&&(i.$$.bound[n]=t,t(i.$$.ctx[n]))}function L(i){i&&i.c()}function D(i,e,t){const{fragment:n,after_update:l}=i.$$;n&&n.m(e,t),Ne(()=>{const s=i.$$.on_mount.map(Be).filter(ke);i.$$.on_destroy?i.$$.on_destroy.push(...s):re(s),i.$$.on_mount=[]}),l.forEach(Ne)}function E(i,e){const t=i.$$;t.fragment!==null&&(an(t.after_update),re(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function cn(i,e){i.$$.dirty[0]===-1&&(ce.push(i),ln(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function I(i,e,t,n,l,s,r=null,a=[-1]){const o=ve;pe(i);const f=i.$$={fragment:null,ctx:[],props:s,update:j,not_equal:l,bound:ze(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:ze(),dirty:a,skip_bound:!1,root:e.target||o.$$.root};r&&r(f.root);let u=!1;if(f.ctx=t?t(i,e.props||{},(c,d,...h)=>{const g=h.length?h[0]:d;return f.ctx&&l(f.ctx[c],f.ctx[c]=g)&&(!f.skip_bound&&f.bound[c]&&f.bound[c](g),u&&cn(i,c)),d}):[],f.update(),u=!0,re(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const c=Kt(e.target);f.fragment&&f.fragment.l(c),c.forEach(p)}else f.fragment&&f.fragment.c();e.intro&&w(i.$$.fragment),D(i,e.target,e.anchor),Ze()}pe(o)}class q{$$=void 0;$$set=void 0;$destroy(){E(this,1),this.$destroy=j}$on(e,t){if(!ke(t))return j;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const l=n.indexOf(t);l!==-1&&n.splice(l,1)}}$set(e){this.$$set&&!Yt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const un="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(un);function dn(i){let e,t=i[0]&&i[0].avatar&&Ge(i);return{c(){e=_("div"),t&&t.c(),m(e,"class","avatar svelte-1e5yp5n")},m(n,l){k(n,e,l),t&&t.m(e,null)},p(n,l){n[0]&&n[0].avatar?t?t.p(n,l):(t=Ge(n),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(n){n&&p(e),t&&t.d()}}}function Ge(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[0].avatar)||m(e,"src",t),m(e,"alt","agent avatar"),m(e,"class","svelte-1e5yp5n")},m(n,l){k(n,e,l)},p(n,l){l&1&&!X(e.src,t=n[0].avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function hn(i){let e,t;const n=i[4].default,l=W(n,i,i[3],null);return{c(){e=_("div"),l&&l.c(),m(e,"class","message svelte-1e5yp5n")},m(s,r){k(s,e,r),l&&l.m(e,null),t=!0},p(s,r){l&&l.p&&(!t||r&8)&&U(l,n,s,s[3],t?Y(n,s[3],r,null):Z(s[3]),null)},i(s){t||(w(l,s),t=!0)},o(s){S(l,s),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function gn(i){let e,t,n,l,s,r;const a=i[4].default,o=W(a,i,i[3],null);return{c(){e=_("div"),t=_("div"),n=_("div"),o&&o.c(),l=A(),s=_("div"),s.innerHTML='<div class="icon svelte-1e5yp5n"><i class="wxi-content-copy svelte-1e5yp5n"></i></div> <div class="icon svelte-1e5yp5n"><i class="wxi-redo svelte-1e5yp5n"></i></div> <div class="icon svelte-1e5yp5n"><i class="wxi-dots-v svelte-1e5yp5n"></i></div>',m(n,"class","message svelte-1e5yp5n"),m(t,"class","massages-wrapper svelte-1e5yp5n"),m(s,"class","controls svelte-1e5yp5n"),m(e,"class","blocks svelte-1e5yp5n")},m(f,u){k(f,e,u),b(e,t),b(t,n),o&&o.m(n,null),b(e,l),b(e,s),r=!0},p(f,u){o&&o.p&&(!r||u&8)&&U(o,a,f,f[3],r?Y(a,f[3],u,null):Z(f[3]),null)},i(f){r||(w(o,f),r=!0)},o(f){S(o,f),r=!1},d(f){f&&p(e),o&&o.d(f)}}}function mn(i){let e,t,n,l,s,r,a=i[1]&&dn(i);const o=[gn,hn],f=[];function u(c,d){return c[1]?0:1}return l=u(i),s=f[l]=o[l](i),{c(){e=_("div"),t=_("div"),a&&a.c(),n=A(),s.c(),m(t,"class","wrapper svelte-1e5yp5n"),m(e,"class","container svelte-1e5yp5n"),B(e,"agent",i[1])},m(c,d){k(c,e,d),b(e,t),a&&a.m(t,null),b(t,n),f[l].m(t,null),r=!0},p(c,[d]){c[1]&&a.p(c,d),s.p(c,d)},i(c){r||(w(s),r=!0)},o(c){S(s),r=!1},d(c){c&&p(e),a&&a.d(),f[l].d()}}}function _n(i,e,t){let{$$slots:n={},$$scope:l}=e,{role:s}=e,{author:r}=e;const a=s==="agent";return i.$$set=o=>{"role"in o&&t(2,s=o.role),"author"in o&&t(0,r=o.author),"$$scope"in o&&t(3,l=o.$$scope)},[r,a,s,l,n]}class bn extends q{constructor(e){super(),I(this,e,_n,mn,O,{role:2,author:0})}}function vn(i){let e,t=i[0]&&i[0].avatar&&Ke(i);return{c(){e=_("div"),t&&t.c(),m(e,"class","avatar svelte-qghbhf")},m(n,l){k(n,e,l),t&&t.m(e,null)},p(n,l){n[0]&&n[0].avatar?t?t.p(n,l):(t=Ke(n),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},d(n){n&&p(e),t&&t.d()}}}function Ke(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[0].avatar)||m(e,"src",t),m(e,"alt","agent avatar"),m(e,"class","svelte-qghbhf")},m(n,l){k(n,e,l)},p(n,l){l&1&&!X(e.src,t=n[0].avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function pn(i){let e,t;const n=i[4].default,l=W(n,i,i[3],null);return{c(){e=_("div"),l&&l.c(),m(e,"class","message svelte-qghbhf")},m(s,r){k(s,e,r),l&&l.m(e,null),t=!0},p(s,r){l&&l.p&&(!t||r&8)&&U(l,n,s,s[3],t?Y(n,s[3],r,null):Z(s[3]),null)},i(s){t||(w(l,s),t=!0)},o(s){S(l,s),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function wn(i){let e,t,n,l,s;const r=i[4].default,a=W(r,i,i[3],null);return{c(){e=_("div"),t=_("div"),a&&a.c(),n=A(),l=_("div"),l.innerHTML='<i class="wxi-content-copy svelte-qghbhf"></i>',m(t,"class","message svelte-qghbhf"),m(l,"class","icon svelte-qghbhf"),m(e,"class","agent-message svelte-qghbhf")},m(o,f){k(o,e,f),b(e,t),a&&a.m(t,null),b(e,n),b(e,l),s=!0},p(o,f){a&&a.p&&(!s||f&8)&&U(a,r,o,o[3],s?Y(r,o[3],f,null):Z(o[3]),null)},i(o){s||(w(a,o),s=!0)},o(o){S(a,o),s=!1},d(o){o&&p(e),a&&a.d(o)}}}function kn(i){let e,t,n,l,s,r=i[0].name+"",a,o,f,u,c,d=i[1]&&vn(i);const h=[wn,pn],g=[];function v(M,H){return M[1]?0:1}return f=v(i),u=g[f]=h[f](i),{c(){e=_("div"),t=_("div"),d&&d.c(),n=A(),l=_("div"),s=_("span"),a=F(r),o=A(),u.c(),m(s,"class","name svelte-qghbhf"),m(l,"class","main svelte-qghbhf"),m(t,"class","wrapper svelte-qghbhf"),m(e,"class","container svelte-qghbhf"),B(e,"agent",i[1])},m(M,H){k(M,e,H),b(e,t),d&&d.m(t,null),b(t,n),b(t,l),b(l,s),b(s,a),b(l,o),g[f].m(l,null),c=!0},p(M,[H]){M[1]&&d.p(M,H),(!c||H&1)&&r!==(r=M[0].name+"")&&z(a,r),u.p(M,H)},i(M){c||(w(u),c=!0)},o(M){S(u),c=!1},d(M){M&&p(e),d&&d.d(),g[f].d()}}}function yn(i,e,t){let{$$slots:n={},$$scope:l}=e,{role:s}=e,{author:r={name:"You"}}=e;const a=s==="agent";return i.$$set=o=>{"role"in o&&t(2,s=o.role),"author"in o&&t(0,r=o.author),"$$scope"in o&&t(3,l=o.$$scope)},[r,a,s,l,n]}class Mn extends q{constructor(e){super(),I(this,e,yn,kn,O,{role:2,author:0})}}function Cn(i){let e,t,n,l,s=i[0].name+"",r,a,o,f=i[0].avatar&&Qe(i);return{c(){e=_("div"),t=_("div"),f&&f.c(),n=A(),l=_("span"),r=F(s),a=A(),o=_("div"),o.innerHTML='<i class="wxi-content-copy svelte-tp21bu"></i>',m(t,"class","avatar svelte-tp21bu"),m(l,"class","name svelte-tp21bu"),m(o,"class","icon svelte-tp21bu"),m(e,"class","toolbar svelte-tp21bu")},m(u,c){k(u,e,c),b(e,t),f&&f.m(t,null),b(e,n),b(e,l),b(l,r),b(e,a),b(e,o)},p(u,c){u[0].avatar?f?f.p(u,c):(f=Qe(u),f.c(),f.m(t,null)):f&&(f.d(1),f=null),c&1&&s!==(s=u[0].name+"")&&z(r,s)},d(u){u&&p(e),f&&f.d()}}}function Qe(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[0].avatar)||m(e,"src",t),m(e,"alt","agent avatar"),m(e,"class","svelte-tp21bu")},m(n,l){k(n,e,l)},p(n,l){l&1&&!X(e.src,t=n[0].avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function Sn(i){let e,t,n,l,s=i[1]&&Cn(i);const r=i[4].default,a=W(r,i,i[3],null);return{c(){e=_("div"),s&&s.c(),t=A(),n=_("div"),a&&a.c(),m(n,"class","message svelte-tp21bu"),m(e,"class","container svelte-tp21bu"),B(e,"agent",i[1])},m(o,f){k(o,e,f),s&&s.m(e,null),b(e,t),b(e,n),a&&a.m(n,null),l=!0},p(o,[f]){o[1]&&s.p(o,f),a&&a.p&&(!l||f&8)&&U(a,r,o,o[3],l?Y(r,o[3],f,null):Z(o[3]),null)},i(o){l||(w(a,o),l=!0)},o(o){S(a,o),l=!1},d(o){o&&p(e),s&&s.d(),a&&a.d(o)}}}function Nn(i,e,t){let{$$slots:n={},$$scope:l}=e,{role:s}=e,{author:r}=e;const a=s==="agent";return i.$$set=o=>{"role"in o&&t(2,s=o.role),"author"in o&&t(0,r=o.author),"$$scope"in o&&t(3,l=o.$$scope)},[r,a,s,l,n]}class Tn extends q{constructor(e){super(),I(this,e,Nn,Sn,O,{role:2,author:0})}}function An(i){let e,t=Xe(i[0].name)+"",n;return{c(){e=_("span"),n=F(t),m(e,"class","initials svelte-phcvex")},m(l,s){k(l,e,s),b(e,n)},p(l,s){s&1&&t!==(t=Xe(l[0].name)+"")&&z(n,t)},d(l){l&&p(e)}}}function Hn(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[0].avatar)||m(e,"src",t),m(e,"alt","agent avatar"),m(e,"class","svelte-phcvex")},m(n,l){k(n,e,l)},p(n,l){l&1&&!X(e.src,t=n[0].avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function Dn(i){let e;return{c(){e=_("div"),e.innerHTML='<i class="wxi-content-copy svelte-phcvex"></i>',m(e,"class","icon svelte-phcvex")},m(t,n){k(t,e,n)},d(t){t&&p(e)}}}function En(i){let e,t,n,l,s,r,a=i[0].name+"",o,f,u,c,d;function h(y,C){return y[0]&&y[0].avatar?Hn:An}let g=h(i),v=g(i),M=i[1]&&Dn();const H=i[4].default,N=W(H,i,i[3],null);return{c(){e=_("div"),t=_("div"),v.c(),n=A(),l=_("div"),s=_("div"),r=_("span"),o=F(a),f=A(),M&&M.c(),u=A(),c=_("div"),N&&N.c(),m(t,"class","avatar-icon svelte-phcvex"),m(r,"class","name svelte-phcvex"),m(s,"class","toolbar svelte-phcvex"),m(c,"class","message svelte-phcvex"),m(l,"class","wrapper svelte-phcvex"),m(e,"class","container svelte-phcvex"),B(e,"agent",i[1])},m(y,C){k(y,e,C),b(e,t),v.m(t,null),b(e,n),b(e,l),b(l,s),b(s,r),b(r,o),b(s,f),M&&M.m(s,null),b(l,u),b(l,c),N&&N.m(c,null),d=!0},p(y,[C]){g===(g=h(y))&&v?v.p(y,C):(v.d(1),v=g(y),v&&(v.c(),v.m(t,null))),(!d||C&1)&&a!==(a=y[0].name+"")&&z(o,a),N&&N.p&&(!d||C&8)&&U(N,H,y,y[3],d?Y(H,y[3],C,null):Z(y[3]),null)},i(y){d||(w(N,y),d=!0)},o(y){S(N,y),d=!1},d(y){y&&p(e),v.d(),M&&M.d(),N&&N.d(y)}}}function Xe(i){return i.split(" ").map(e=>e[0].toUpperCase()).join("")}function jn(i,e,t){let{$$slots:n={},$$scope:l}=e,{role:s}=e,{author:r={name:"You"}}=e;const a=s==="agent";return i.$$set=o=>{"role"in o&&t(2,s=o.role),"author"in o&&t(0,r=o.author),"$$scope"in o&&t(3,l=o.$$scope)},[r,a,s,l,n]}class On extends q{constructor(e){super(),I(this,e,jn,En,O,{role:2,author:0})}}function xe(i,e,t){let n,l,s,r,a,o,f,u;if(e?{linestart:f,headerlevel:s,checkbehind:a,unsurepoint:o,content:n,ctype:l,newLineCounter:r,i:u}=e.state:(e={nodes:[{d:[],t:"p",f:!1,i:0}],length:0,state:{}},f=0,s=0,a=-1,o=-1,n="",l="",r=0,u=0),o){const h=e.nodes[e.nodes.length-1];h.d.length&&(e.length-=h.d[h.d.length-1].c.length,h.d.pop())}const c=h=>{n!==""&&d("",h);const g=e.nodes[e.nodes.length-1];g.f=h!==1,g.i=u,s>0&&(g.t=`h${s}`,s=-1),h===0&&e.nodes.push({d:[],t:"p",f:!1,i:0})},d=(h,g=2)=>{const v=e.nodes[e.nodes.length-1],M=v.d[v.d.length-1],H=g===2?l:"";if(M&&M.t===H&&o<0){const N=M;e.length+=n.length,N.c=N.c+n,N.i=u}else{const N=H===""&&o>=0?i.substring(o):n;e.length+=N.length,v.d.push({c:N,t:H,f:g!==1,i:u})}g===2&&(h?o=a:o=-1),g!==1&&(n="",l=h,a=-1)};for(;u<i.length;u++){const h=i[u];if(h===`
    `){r++,f=u+1;continue}if(!((h===" "||h==="	")&&r>0))if(r>0&&(r>1?c(0):n+=`
    `,r=0),h=="*"||h=="`"||h=="#")i[u-1]=="\\"?n+=h:a===-1&&(a=u);else{if(a>=0){const g=u-a;if(i[u-1]=="*")g===2?d(l==="strong"?"":"strong"):g===1&&d(l==="em"?"":"em"),a=-1;else if(i[u-1]=="`"&&g==1)d(l==="code"?"":"code"),a=-1;else if(i[u-1]=="#"&&i[u]===" "&&a===f&&u-a<=6){s=u-a,a=-1;continue}}a!==-1&&(n+=i.substring(a,u),a=-1),n+=h}}return c(t?1:-1),t?e.state={linestart:f,headerlevel:s,checkbehind:a,unsurepoint:o,content:n,ctype:l,newLineCounter:r,i:u}:e.state={},e}function $e(i,e,t,n,l){if(i)return et(i,e.nodes,t,n,0,l)===0}function et(i,e,t,n,l,s){let r=0,a=0,o=null,f=null;const u=t[l];u&&(r=u.nodeIndex,a=u.textIndex,o=u.target,f=u.temp);for(let c=r;c<e.length;c++){const d=e[c];if(typeof d.d<"u"){const h=e[c];if(o||(o=document.createElement(h.t),i.appendChild(o)),n=et(o,h.d,t,n,l+1,s),!n)return t[l]={nodeIndex:c,textIndex:0,target:o},0;o=null}else{let h;const g=d;if(g.c.length-a>n?(h=g.c.substring(a,a+n),a+=n,n=0):(h=g.c.substring(a),n-=g.c.length-a,a=0),g.t)o?o.textContent+=h:(o=document.createElement(g.t),i.insertBefore(o,f),o.textContent=h);else if(o)o.textContent+=h;else{const v=document.createTextNode(h);i.insertBefore(v,f)}if(n===0)return f||(f=Ln(i,s)),t[l]=a?{temp:f,nodeIndex:c,textIndex:a,target:o}:{temp:f,nodeIndex:c+1,textIndex:0,target:null},n;o=null}}return t[l]=null,f&&f.parentNode.removeChild(f),n}function Ln(i,e){const t=document.createElement("div");return t.className=e,t.textContent=" ",i.appendChild(t),t}function tt(i){let e="";for(const t of i)typeof t.d<"u"?(e+="<"+t.t+">",e+=tt(t.d),e+="</"+t.t+">"):(t.t&&(e+="<"+t.t+">"),e+=t.c,t.t&&(e+="</"+t.t+">"));return e}function nt(i){return tt(xe(i).nodes)}function In(i){let e,t=nt(i[0])+"",n;return{c(){e=new Ye(!1),n=x(),e.a=n},m(l,s){e.m(t,l,s),k(l,n,s)},p(l,[s]){s&1&&t!==(t=nt(l[0])+"")&&e.p(t)},i:j,o:j,d(l){l&&(p(n),e.d())}}}function qn(i,e,t){let{text:n}=e;return i.$$set=l=>{"text"in l&&t(0,n=l.text)},[n]}class Pn extends q{constructor(e){super(),I(this,e,qn,In,O,{text:0})}}function it(i){let e,t,n=0,l,s,r,a,o,f;const u=g=>{const v=typeof g=="object"?g:{finalized:g<=0};s=v.lettersMin||1,r=v.lettersMax||50,a=v.fps||30,o=v.expectedDelay||7e3,f=v.finalized},c=g=>{e=g,l=new Date,d()};function d(){t||(t=requestAnimationFrame(()=>{t=null,h()}))}function h(){const g=o-(new Date-l);let v=Math.round((e-n)/(a*g/1e3));v<1&&Math.random()<v?v=0:(v=Math.min(r,Math.max(s,v+Math.floor(Math.random()*2)-1)),n+v>e&&(v=e-n));let M=!1;v&&(n+=v,M=i(f&&n>=e?-1:n,v)),M?setTimeout(d,1e3/a-5):f||setTimeout(d,300)}return{update:c,config:u}}function Fn(i){let e;return{c(){e=_("div"),m(e,"class","wx-md svelte-t1424q")},m(t,n){k(t,e,n),i[3](e)},p:j,i:j,o:j,d(t){t&&p(e),i[3](null)}}}function Rn(i,e,t){let{text:n}=e,{typing:l=0}=e,s=null,r=[],a=null;const o=(d,h)=>d===-1?$e(a,s,r,1e5,"wx-cursor"):$e(a,s,r,h,"wx-cursor");function f(){const d=typeof l=="number"?l>0:!l.finalized;s=xe(n,s,d),u.update(s.length)}let u=it(o);function c(d){ee[d?"unshift":"push"](()=>{a=d,t(0,a)})}return i.$$set=d=>{"text"in d&&t(1,n=d.text),"typing"in d&&t(2,l=d.typing)},i.$$.update=()=>{i.$$.dirty&4&&u.config(l),i.$$.dirty&2&&f()},[a,n,l,c]}class Bn extends q{constructor(e){super(),I(this,e,Rn,Fn,O,{text:1,typing:2})}}function zn(i){let e;return{c(){e=F(i[0])},m(t,n){k(t,e,n)},p(t,[n]){n&1&&z(e,t[0])},i:j,o:j,d(t){t&&p(e)}}}function Vn(i,e,t){let{text:n}=e;return i.$$set=l=>{"text"in l&&t(0,n=l.text)},[n]}class Wn extends q{constructor(e){super(),I(this,e,Vn,zn,O,{text:0})}}function Yn(i){let e;return{c(){e=_("div"),e.textContent=" ",m(e,"class","cursor svelte-1yks60f")},m(t,n){k(t,e,n)},p:j,i:j,o:j,d(t){t&&p(e)}}}class Un extends q{constructor(e){super(),I(this,e,null,Yn,O,{})}}function lt(i){let e,t;return e=new Un({}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Zn(i){let e,t,n,l=i[0]&&!i[1]&&lt();return{c(){e=F(i[2]),l&&l.c(),t=x()},m(s,r){k(s,e,r),l&&l.m(s,r),k(s,t,r),n=!0},p(s,[r]){(!n||r&4)&&z(e,s[2]),s[0]&&!s[1]?l?r&3&&w(l,1):(l=lt(),l.c(),w(l,1),l.m(t.parentNode,t)):l&&(J(),S(l,1,1,()=>{l=null}),G())},i(s){n||(w(l),n=!0)},o(s){S(l),n=!1},d(s){s&&(p(e),p(t)),l&&l.d(s)}}}function Jn(i,e,t){let{text:n}=e,{typing:l=0}=e,s=!1,r="",o=it(f=>{if(f===-1)t(1,s=!0),t(2,r=n);else return t(2,r=n.substring(0,f)),f<n.length});return i.$$set=f=>{"text"in f&&t(3,n=f.text),"typing"in f&&t(0,l=f.typing)},i.$$.update=()=>{i.$$.dirty&1&&o.config(l),i.$$.dirty&8&&o.update(n.length)},[l,s,r,n]}class Gn extends q{constructor(e){super(),I(this,e,Jn,Zn,O,{text:3,typing:0})}}const Kn={blocks:bn,bubbles:Mn,cards:Tn,flow:On},Qn={markdown:[Pn,Bn],text:[Wn,Gn]};function Xn(i){let e,t,n;var l=i[4];function s(r,a){return{props:{text:r[0],typing:r[2]}}}return l&&(e=Se(l,s(i))),{c(){e&&L(e.$$.fragment),t=x()},m(r,a){e&&D(e,r,a),k(r,t,a),n=!0},p(r,a){if(a&16&&l!==(l=r[4])){if(e){J();const o=e;S(o.$$.fragment,1,0,()=>{E(o,1)}),G()}l?(e=Se(l,s(r)),L(e.$$.fragment),w(e.$$.fragment,1),D(e,t.parentNode,t)):e=null}else if(l){const o={};a&1&&(o.text=r[0]),a&4&&(o.typing=r[2]),e.$set(o)}},i(r){n||(e&&w(e.$$.fragment,r),n=!0)},o(r){e&&S(e.$$.fragment,r),n=!1},d(r){r&&p(t),e&&E(e,r)}}}function xn(i){let e,t,n;var l=i[5];function s(r,a){return{props:{role:r[1],author:r[3],$$slots:{default:[Xn]},$$scope:{ctx:r}}}}return l&&(e=Se(l,s(i))),{c(){e&&L(e.$$.fragment),t=x()},m(r,a){e&&D(e,r,a),k(r,t,a),n=!0},p(r,[a]){if(l!==(l=r[5])){if(e){J();const o=e;S(o.$$.fragment,1,0,()=>{E(o,1)}),G()}l?(e=Se(l,s(r)),L(e.$$.fragment),w(e.$$.fragment,1),D(e,t.parentNode,t)):e=null}else if(l){const o={};a&2&&(o.role=r[1]),a&8&&(o.author=r[3]),a&277&&(o.$$scope={dirty:a,ctx:r}),e.$set(o)}},i(r){n||(e&&w(e.$$.fragment,r),n=!0)},o(r){e&&S(e.$$.fragment,r),n=!1},d(r){r&&p(t),e&&E(e,r)}}}function $n(i,e,t){let{text:n}=e,{role:l}=e,{typing:s=0}=e,{render:r="blocks"}=e,{format:a="text"}=e,{author:o}=e;const f=typeof r=="string"?Kn[r]:r;let u=typeof a=="string"?Qn[a]:a;return Array.isArray(u)&&(u=u[s?1:0]),i.$$set=c=>{"text"in c&&t(0,n=c.text),"role"in c&&t(1,l=c.role),"typing"in c&&t(2,s=c.typing),"render"in c&&t(6,r=c.render),"format"in c&&t(7,a=c.format),"author"in c&&t(3,o=c.author)},[n,l,s,o,u,f,r,a]}class st extends q{constructor(e){super(),I(this,e,$n,xn,O,{text:0,role:1,typing:2,render:6,format:7,author:3})}}function rt(i,e,t){const n=i.slice();return n[5]=e[t],n}function at(i){let e,t,n,l;return n=new st({props:{text:i[3].message||"Hello! How can I help you?",role:"agent",author:i[3]}}),{c(){e=_("div"),t=A(),L(n.$$.fragment)},m(s,r){k(s,e,r),k(s,t,r),D(n,s,r),l=!0},p(s,r){const a={};r&8&&(a.text=s[3].message||"Hello! How can I help you?"),r&8&&(a.author=s[3]),n.$set(a)},i(s){l||(w(n.$$.fragment,s),l=!0)},o(s){S(n.$$.fragment,s),l=!1},d(s){s&&(p(e),p(t)),E(n,s)}}}function ot(i,e){let t,n,l;return n=new st({props:{text:e[5].content,role:e[5].role,typing:e[5].typing,author:e[5].author,render:e[1],format:e[5].format||e[2]}}),{key:i,first:null,c(){t=x(),L(n.$$.fragment),this.first=t},m(s,r){k(s,t,r),D(n,s,r),l=!0},p(s,r){e=s;const a={};r&1&&(a.text=e[5].content),r&1&&(a.role=e[5].role),r&1&&(a.typing=e[5].typing),r&1&&(a.author=e[5].author),r&2&&(a.render=e[1]),r&5&&(a.format=e[5].format||e[2]),n.$set(a)},i(s){l||(w(n.$$.fragment,s),l=!0)},o(s){S(n.$$.fragment,s),l=!1},d(s){s&&p(t),E(n,s)}}}function ei(i){let e,t,n=[],l=new Map,s,r,a=!i[0].length&&i[3]&&at(i),o=te(i[0]);const f=u=>u[5].id;for(let u=0;u<o.length;u+=1){let c=rt(i,o,u),d=f(c);l.set(d,n[u]=ot(d,c))}return{c(){e=_("div"),a&&a.c(),t=A();for(let u=0;u<n.length;u+=1)n[u].c();m(e,"class",s="messages "+i[4]+" svelte-qm0dc9")},m(u,c){k(u,e,c),a&&a.m(e,null),b(e,t);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(e,null);r=!0},p(u,[c]){!u[0].length&&u[3]?a?(a.p(u,c),c&9&&w(a,1)):(a=at(u),a.c(),w(a,1),a.m(e,t)):a&&(J(),S(a,1,1,()=>{a=null}),G()),c&7&&(o=te(u[0]),J(),n=qe(n,c,f,1,u,o,l,e,on,ot,null,rt),G()),(!r||c&16&&s!==(s="messages "+u[4]+" svelte-qm0dc9"))&&m(e,"class",s)},i(u){if(!r){w(a);for(let c=0;c<o.length;c+=1)w(n[c]);r=!0}},o(u){S(a);for(let c=0;c<n.length;c+=1)S(n[c]);r=!1},d(u){u&&p(e),a&&a.d();for(let c=0;c<n.length;c+=1)n[c].d()}}}function ti(i,e,t){let n,{data:l}=e,{render:s="blocks"}=e,{format:r}=e,{agent:a=null}=e;return i.$$set=o=>{"data"in o&&t(0,l=o.data),"render"in o&&t(1,s=o.render),"format"in o&&t(2,r=o.format),"agent"in o&&t(3,a=o.agent)},i.$$.update=()=>{i.$$.dirty&2&&t(4,n=typeof s=="string"?s:"blocks")},[l,s,r,a,n]}class ni extends q{constructor(e){super(),I(this,e,ti,ei,O,{data:0,render:1,format:2,agent:3})}}let ft=new Date().valueOf();function ii(){return ft+=1,ft}function ct(i){return i&&typeof i=="object"&&!Array.isArray(i)}function Pe(i,e){for(const t in e){const n=e[t];ct(i[t])&&ct(n)?i[t]=Pe({...i[t]},e[t]):i[t]=e[t]}return i}function ut(i){return{getGroup(e){const t=i[e];return n=>t&&t[n]||n},getRaw(){return i},extend(e,t){if(!e)return this;let n;return t?n=Pe({...e},i):n=Pe({...i},e),ut(n)}}}function li(i){let e,t,n;return{c(){e=_("textarea"),m(e,"id",i[1]),e.disabled=i[4],m(e,"placeholder",i[2]),e.readOnly=i[6],m(e,"title",i[3]),m(e,"class","svelte-1e9cxd5"),B(e,"error",i[5])},m(l,s){k(l,e,s),We(e,i[0]),t||(n=ie(e,"input",i[7]),t=!0)},p(l,[s]){s&2&&m(e,"id",l[1]),s&16&&(e.disabled=l[4]),s&4&&m(e,"placeholder",l[2]),s&64&&(e.readOnly=l[6]),s&8&&m(e,"title",l[3]),s&1&&We(e,l[0]),s&32&&B(e,"error",l[5])},i:j,o:j,d(l){l&&p(e),t=!1,n()}}}function si(i,e,t){let{value:n=""}=e,{id:l=ii()}=e,{placeholder:s=""}=e,{title:r=""}=e,{disabled:a=!1}=e,{error:o=!1}=e,{readonly:f=!1}=e;function u(){n=this.value,t(0,n)}return i.$$set=c=>{"value"in c&&t(0,n=c.value),"id"in c&&t(1,l=c.id),"placeholder"in c&&t(2,s=c.placeholder),"title"in c&&t(3,r=c.title),"disabled"in c&&t(4,a=c.disabled),"error"in c&&t(5,o=c.error),"readonly"in c&&t(6,f=c.readonly)},[n,l,s,r,a,o,f,u]}class ri extends q{constructor(e){super(),I(this,e,si,li,O,{value:0,id:1,placeholder:2,title:3,disabled:4,error:5,readonly:6})}}function dt(i){let e,t;return{c(){e=_("i"),m(e,"class",t=Me(i[0])+" svelte-16d1jeh")},m(n,l){k(n,e,l)},p(n,l){l&1&&t!==(t=Me(n[0])+" svelte-16d1jeh")&&m(e,"class",t)},d(n){n&&p(e)}}}function ai(i){let e;return{c(){e=F(i[3])},m(t,n){k(t,e,n)},p(t,n){n&8&&z(e,t[3])},i:j,o:j,d(t){t&&p(e)}}}function oi(i){let e;const t=i[11].default,n=W(t,i,i[10],null);return{c(){n&&n.c()},m(l,s){n&&n.m(l,s),e=!0},p(l,s){n&&n.p&&(!e||s&1024)&&U(n,t,l,l[10],e?Y(t,l[10],s,null):Z(l[10]),null)},i(l){e||(w(n,l),e=!0)},o(l){S(n,l),e=!1},d(l){n&&n.d(l)}}}function fi(i){let e,t,n,l,s,r,a,o,f=i[0]&&dt(i);const u=[oi,ai],c=[];function d(h,g){return h[5]?0:1}return n=d(i),l=c[n]=u[n](i),{c(){e=_("button"),f&&f.c(),t=A(),l.c(),m(e,"title",i[2]),m(e,"class",s=Me(i[4])+" svelte-16d1jeh"),e.disabled=i[1],B(e,"icon",i[0]&&(!i[5]||!i[5].default))},m(h,g){k(h,e,g),f&&f.m(e,null),b(e,t),c[n].m(e,null),r=!0,a||(o=ie(e,"click",i[6]),a=!0)},p(h,[g]){h[0]?f?f.p(h,g):(f=dt(h),f.c(),f.m(e,t)):f&&(f.d(1),f=null),l.p(h,g),(!r||g&4)&&m(e,"title",h[2]),(!r||g&16&&s!==(s=Me(h[4])+" svelte-16d1jeh"))&&m(e,"class",s),(!r||g&2)&&(e.disabled=h[1]),(!r||g&49)&&B(e,"icon",h[0]&&(!h[5]||!h[5].default))},i(h){r||(w(l),r=!0)},o(h){S(l),r=!1},d(h){h&&p(e),f&&f.d(),c[n].d(),a=!1,o()}}}function ci(i,e,t){let{$$slots:n={},$$scope:l}=e,{type:s=""}=e,{css:r=""}=e,{click:a}=e,{icon:o=""}=e,{disabled:f=!1}=e,{title:u=""}=e,{text:c=""}=e;const d=e.$$slots;let h;const g=fe(),v=M=>{f||(g("click"),a&&a(M))};return i.$$set=M=>{t(13,e=ne(ne({},e),ae(M))),"type"in M&&t(7,s=M.type),"css"in M&&t(8,r=M.css),"click"in M&&t(9,a=M.click),"icon"in M&&t(0,o=M.icon),"disabled"in M&&t(1,f=M.disabled),"title"in M&&t(2,u=M.title),"text"in M&&t(3,c=M.text),"$$scope"in M&&t(10,l=M.$$scope)},i.$$.update=()=>{i.$$.dirty&384&&t(4,h=r+(s?(r?" ":"")+s:""))},e=ae(e),[o,f,u,c,h,d,v,s,r,a,l,n]}class ht extends q{constructor(e){super(),I(this,e,ci,fi,O,{type:7,css:8,click:9,icon:0,disabled:1,title:2,text:3})}}const{document:ui}=Zt;function di(i){let e,t,n,l,s;const r=i[8].default,a=W(r,i,i[7],null);return{c(){e=A(),t=_("div"),a&&a.c(),m(t,"class","popup svelte-yvdrgm"),be(t,"top",i[1]+"px"),be(t,"left",i[0]+"px")},m(o,f){k(o,e,f),k(o,t,f),a&&a.m(t,null),i[9](t),n=!0,l||(s=ie(ui.body,"mousedown",i[3]),l=!0)},p(o,[f]){a&&a.p&&(!n||f&128)&&U(a,r,o,o[7],n?Y(r,o[7],f,null):Z(o[7]),null),(!n||f&2)&&be(t,"top",o[1]+"px"),(!n||f&1)&&be(t,"left",o[0]+"px")},i(o){n||(w(a,o),n=!0)},o(o){S(a,o),n=!1},d(o){o&&(p(e),p(t)),a&&a.d(o),i[9](null),l=!1,s()}}}function hi(i,e,t){let{$$slots:n={},$$scope:l}=e,{left:s=0}=e,{top:r=0}=e,{area:a=null}=e,{cancel:o}=e,{mount:f}=e,u;function c(){if(!u)return;const g=document.body.getBoundingClientRect(),v=u.getBoundingClientRect();v.right>=g.right&&t(0,s=g.right-v.width),v.bottom>=g.bottom&&t(1,r=g.bottom-v.height-12)}a&&(f&&f(c),$t(()=>c()));function d(g){u.contains(g.target)||o&&o(g)}function h(g){ee[g?"unshift":"push"](()=>{u=g,t(2,u)})}return i.$$set=g=>{"left"in g&&t(0,s=g.left),"top"in g&&t(1,r=g.top),"area"in g&&t(4,a=g.area),"cancel"in g&&t(5,o=g.cancel),"mount"in g&&t(6,f=g.mount),"$$scope"in g&&t(7,l=g.$$scope)},i.$$.update=()=>{i.$$.dirty&16&&a&&(t(1,r=a.top+a.height),t(0,s=a.left))},[s,r,u,d,a,o,f,l,n,h]}class gi extends q{constructor(e){super(),I(this,e,hi,di,O,{left:0,top:1,area:4,cancel:5,mount:6})}}const mi=i=>({}),gt=i=>({mount:i[1]});function _i(i){let e,t,n,l;const s=i[5].default,r=W(s,i,i[4],gt);return{c(){e=_("div"),t=_("div"),r&&r.c(),m(t,"class",n="wx-"+i[0]+"-theme svelte-15a98dp"),m(e,"class","wx-clone svelte-15a98dp")},m(a,o){k(a,e,o),b(e,t),r&&r.m(t,null),i[6](t),l=!0},p(a,[o]){r&&r.p&&(!l||o&16)&&U(r,s,a,a[4],l?Y(s,a[4],o,mi):Z(a[4]),gt),(!l||o&1&&n!==(n="wx-"+a[0]+"-theme svelte-15a98dp"))&&m(t,"class",n)},i(a){l||(w(r,a),l=!0)},o(a){S(r,a),l=!1},d(a){a&&p(e),r&&r.d(a),i[6](null)}}}function bi(i){for(;i!==document.body&&!i.getAttribute("data-wx-portal-root");)i=i.parentNode;return i}function vi(i,e,t){let{$$slots:n={},$$scope:l}=e,s,{theme:r=""}=e,{target:a=void 0}=e,o=[];const f=c=>{o&&o.push(c)};r===""&&(r=je("wx-theme")),Ee(()=>{(a||bi(s)).appendChild(s),o&&o.forEach(d=>d())}),en(()=>{s&&s.parentNode&&s.parentNode.removeChild(s)});function u(c){ee[c?"unshift":"push"](()=>{s=c,t(2,s)})}return i.$$set=c=>{"theme"in c&&t(0,r=c.theme),"target"in c&&t(3,a=c.target),"$$scope"in c&&t(4,l=c.$$scope)},[r,f,s,a,l,n,u]}class pi extends q{constructor(e){super(),I(this,e,vi,_i,O,{theme:0,target:3,mount:1})}get mount(){return this.$$.ctx[1]}}function wi(i){let e,t=`<style>
    @font-face {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 400;
    src: local(''),
        url('https://cdn.webix.com/fonts/roboto/regular.woff2') format('woff2'),
        url('https://cdn.webix.com/fonts/roboto/regular.woff') format('woff');
    }
    @font-face {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 500;
    src: local(''),
        url('https://cdn.webix.com/fonts/roboto/500.woff2') format('woff2'),
        url('https://cdn.webix.com/fonts/roboto/500.woff') format('woff');
    }
    </style>`,n;return{c(){e=new Ye(!1),n=x(),e.a=n},m(l,s){e.m(t,l,s),k(l,n,s)},p:j,i:j,o:j,d(l){l&&(p(n),e.d())}}}class ki extends q{constructor(e){super(),I(this,e,null,wi,O,{})}}function yi(i){let e,t;const n=i[3].default,l=W(n,i,i[2],null);return{c(){e=_("div"),l&&l.c(),m(e,"class","wx-material-theme"),be(e,"height","100%")},m(s,r){k(s,e,r),l&&l.m(e,null),t=!0},p(s,r){l&&l.p&&(!t||r&4)&&U(l,n,s,s[2],t?Y(n,s[2],r,null):Z(s[2]),null)},i(s){t||(w(l,s),t=!0)},o(s){S(l,s),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function mt(i){let e,t,n,l,s,r;return n=new ki({}),{c(){e=_("link"),t=A(),L(n.$$.fragment),l=A(),s=_("link"),m(e,"rel","preconnect"),m(e,"href","https://cdn.webix.com"),m(e,"crossorigin",""),m(s,"rel","stylesheet"),m(s,"href","https://webix.io/dev/fonts/wxi/wx-icons.css")},m(a,o){k(a,e,o),k(a,t,o),D(n,a,o),k(a,l,o),k(a,s,o),r=!0},i(a){r||(w(n.$$.fragment,a),r=!0)},o(a){S(n.$$.fragment,a),r=!1},d(a){a&&(p(e),p(t),p(l),p(s)),E(n,a)}}}function Mi(i){let e,t,n,l=i[1]&&i[1].default&&yi(i),s=i[0]&&mt();return{c(){l&&l.c(),e=A(),s&&s.c(),t=x()},m(r,a){l&&l.m(r,a),k(r,e,a),s&&s.m(document.head,null),b(document.head,t),n=!0},p(r,[a]){r[1]&&r[1].default&&l.p(r,a),r[0]?s?a&1&&w(s,1):(s=mt(),s.c(),w(s,1),s.m(t.parentNode,t)):s&&(J(),S(s,1,1,()=>{s=null}),G())},i(r){n||(w(l),w(s),n=!0)},o(r){S(l),S(s),n=!1},d(r){r&&p(e),l&&l.d(r),s&&s.d(r),p(t)}}}function Ci(i,e,t){let{$$slots:n={},$$scope:l}=e,{fonts:s=!0}=e;const r=e.$$slots;return Ue("wx-theme","material"),i.$$set=a=>{t(4,e=ne(ne({},e),ae(a))),"fonts"in a&&t(0,s=a.fonts),"$$scope"in a&&t(2,l=a.$$scope)},e=ae(e),[s,r,l,n]}class _t extends q{constructor(e){super(),I(this,e,Ci,Mi,O,{fonts:0})}}const Si={core:{ok:"OK",cancel:"Cancel"},calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today",am:["am","AM"],pm:["pm","PM"],weekStart:7,timeFormat:24}};function Ni(i){let e;const t=i[3].default,n=W(t,i,i[2],null);return{c(){n&&n.c()},m(l,s){n&&n.m(l,s),e=!0},p(l,[s]){n&&n.p&&(!e||s&4)&&U(n,t,l,l[2],e?Y(t,l[2],s,null):Z(l[2]),null)},i(l){e||(w(n,l),e=!0)},o(l){S(n,l),e=!1},d(l){n&&n.d(l)}}}function Ti(i,e,t){let{$$slots:n={},$$scope:l}=e,{words:s=null}=e,{optional:r=!1}=e,a=je("wx-i18n");return a||(a=ut(Si)),a=a.extend(s,r),Ue("wx-i18n",a),i.$$set=o=>{"words"in o&&t(0,s=o.words),"optional"in o&&t(1,r=o.optional),"$$scope"in o&&t(2,l=o.$$scope)},[s,r,l,n]}class Ai extends q{constructor(e){super(),I(this,e,Ti,Ni,O,{words:0,optional:1})}}function Hi(i){let e;return{c(){e=F("Send")},m(t,n){k(t,e,n)},d(t){t&&p(e)}}}function Di(i){let e,t,n,l,s,r,a,o,f,u;function c(h){i[3](h)}let d={placeholder:"I'm looking for"};return i[0]!==void 0&&(d.value=i[0]),s=new ri({props:d}),ee.push(()=>fn(s,"value",c)),f=new ht({props:{type:"primary",click:i[2],$$slots:{default:[Hi]},$$scope:{ctx:i}}}),{c(){e=_("div"),t=_("div"),n=_("div"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M22 22H20V20H22V22ZM22 18H20V16H22V18ZM18 22H16V20H18V22ZM18 18H16V16H18V18ZM14 22H12V20H14V22ZM22 14H20V12H22V14Z" fill="#9FA1AE"></path></svg>',l=A(),L(s.$$.fragment),a=A(),o=_("div"),L(f.$$.fragment),m(n,"class","icon svelte-senhap"),m(t,"class","wrapper svelte-senhap"),m(o,"class","bottombar svelte-senhap"),m(e,"class","textarea svelte-senhap"),m(e,"data-focus","yes")},m(h,g){k(h,e,g),b(e,t),b(t,n),b(t,l),D(s,t,null),b(e,a),b(e,o),D(f,o,null),i[4](e),u=!0},p(h,[g]){const v={};!r&&g&1&&(r=!0,v.value=h[0],sn(()=>r=!1)),s.$set(v);const M={};g&128&&(M.$$scope={dirty:g,ctx:h}),f.$set(M)},i(h){u||(w(s.$$.fragment,h),w(f.$$.fragment,h),u=!0)},o(h){S(s.$$.fragment,h),S(f.$$.fragment,h),u=!1},d(h){h&&p(e),E(s),E(f),i[4](null)}}}function Ei(i,e,t){const n=fe();let l,s,r;Ee(()=>{r=s.querySelector("textarea"),r.focus(),r.onkeydown=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),a())}});function a(){l&&(n("post",{value:l}),t(0,l=""),r.focus())}function o(u){l=u,t(0,l)}function f(u){ee[u?"unshift":"push"](()=>{s=u,t(1,s)})}return[l,s,a,o,f]}class ji extends q{constructor(e){super(),I(this,e,Ei,Di,O,{})}}let bt=new Date().valueOf();const vt=()=>bt++;function Oi(){return"temp://"+bt++}class Li{constructor(e){this._nextHandler=null,this._dispatch=e,this.exec=this.exec.bind(this)}async exec(e,t){return this._dispatch(e,t),this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}}function pt(i){let e,t,n;return t=new ji({props:{agent:i[4]}}),t.$on("post",i[5]),{c(){e=_("div"),L(t.$$.fragment),m(e,"class","bottom svelte-19y6dg0")},m(l,s){k(l,e,s),D(t,e,null),n=!0},p(l,s){const r={};s&16&&(r.agent=l[4]),t.$set(r)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){S(t.$$.fragment,l),n=!1},d(l){l&&p(e),E(t)}}}function Ii(i){let e,t,n,l,s;n=new ni({props:{data:i[0],render:i[1],agent:i[4],format:i[2]}});let r=!i[3]&&pt(i);return{c(){e=_("div"),t=_("div"),L(n.$$.fragment),l=A(),r&&r.c(),m(t,"class","top svelte-19y6dg0"),m(e,"class","panel svelte-19y6dg0")},m(a,o){k(a,e,o),b(e,t),D(n,t,null),b(e,l),r&&r.m(e,null),s=!0},p(a,[o]){const f={};o&1&&(f.data=a[0]),o&2&&(f.render=a[1]),o&16&&(f.agent=a[4]),o&4&&(f.format=a[2]),n.$set(f),a[3]?r&&(J(),S(r,1,1,()=>{r=null}),G()):r?(r.p(a,o),o&8&&w(r,1)):(r=pt(a),r.c(),w(r,1),r.m(e,null))},i(a){s||(w(n.$$.fragment,a),w(r),s=!0)},o(a){S(n.$$.fragment,a),S(r),s=!1},d(a){a&&p(e),E(n),r&&r.d()}}}function qi(i,e,t){let{store:n}=e,{data:l=[]}=e,{render:s="blocks"}=e,{format:r="text"}=e,{readonly:a=!1}=e,{agent:o}=e,{user:f}=e;function u(c){const{value:d}=c.detail;if(n){const h=n.getState().activeChat||null;n.in.exec("add-message",{id:h,message:{content:d}})}else l.push({id:vt(),role:"user",author:f,content:d}),t(0,l),o&&o.response(l).then(h=>{h&&(l.push({id:vt(),role:"agent",author:o,...h}),t(0,l))})}return i.$$set=c=>{"store"in c&&t(6,n=c.store),"data"in c&&t(0,l=c.data),"render"in c&&t(1,s=c.render),"format"in c&&t(2,r=c.format),"readonly"in c&&t(3,a=c.readonly),"agent"in c&&t(4,o=c.agent),"user"in c&&t(7,f=c.user)},[l,s,r,a,o,u,n,f]}class wt extends q{constructor(e){super(),I(this,e,qi,Ii,O,{store:6,data:0,render:1,format:2,readonly:3,agent:4,user:7})}}function Pi(i,e){const t=new Date;if(i.getDate()===t.getDate()&&i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear())return"Today";const n=new Date;return n.setDate(t.getDate()-1),i.getDate()===n.getDate()&&i.getMonth()===n.getMonth()&&i.getFullYear()===n.getFullYear()?"Yesterday":e(i)}function Fi(i,e="data-id"){let t=i;for(!t.tagName&&i.target&&(t=i.target);t;){if(t.getAttribute&&t.getAttribute(e))return t;t=t.parentNode}return null}function Ri(i){if(typeof i=="string"){const e=i*1;if(!isNaN(e))return e}return i}function kt(i,e,t){function n(l){const s=Fi(l);if(!s)return;const r=Ri(s.dataset.id);if(typeof e=="function")return e(r,l);let a,o=l.target;for(;o!=s;){if(a=o.dataset?o.dataset.action:null,a&&e[a]){e[a](r,l);return}o=o.parentNode}e[t]&&e[t](r,l)}i.addEventListener(t,n)}function yt(i,e){kt(i,e,"click"),e.dblclick&&kt(i,e.dblclick,"dblclick")}new Date().valueOf();function V(i){return i<10?"0"+i:i.toString()}function Bi(i){const e=V(i);return e.length==2?"0"+e:e}function zi(i){let e=i.getDay();e===0&&(e=7);const t=new Date(i.valueOf());t.setDate(i.getDate()+(4-e));const n=t.getFullYear(),l=Math.floor((t.getTime()-new Date(n,0,1).getTime())/864e5);return 1+Math.floor(l/7)}const Mt=["",""];function Vi(i,e,t){switch(i){case"%d":return V(e.getDate());case"%m":return V(e.getMonth()+1);case"%j":return e.getDate();case"%n":return e.getMonth()+1;case"%y":return V(e.getFullYear()%100);case"%Y":return e.getFullYear();case"%D":return t.dayShort[e.getDay()];case"%l":return t.dayFull[e.getDay()];case"%M":return t.monthShort[e.getMonth()];case"%F":return t.monthFull[e.getMonth()];case"%h":return V((e.getHours()+11)%12+1);case"%g":return(e.getHours()+11)%12+1;case"%G":return e.getHours();case"%H":return V(e.getHours());case"%i":return V(e.getMinutes());case"%a":return((e.getHours()>11?t.pm:t.am)||Mt)[0];case"%A":return((e.getHours()>11?t.pm:t.am)||Mt)[1];case"%s":return V(e.getSeconds());case"%S":return Bi(e.getMilliseconds());case"%W":return V(zi(e));case"%c":{let n=e.getFullYear()+"";return n+="-"+V(e.getMonth()+1),n+="-"+V(e.getDate()),n+="T",n+=V(e.getHours()),n+=":"+V(e.getMinutes()),n+=":"+V(e.getSeconds()),n}default:return i}}const Wi=/%[a-zA-Z]/g;function Yi(i,e){return function(t){return t?(t.getMonth||(t=new Date(t)),i.replace(Wi,n=>Vi(n,t,e))):""}}function Ct(i){return i&&typeof i=="object"&&!Array.isArray(i)}function Fe(i,e){for(const t in e){const n=e[t];Ct(i[t])&&Ct(n)?i[t]=Fe({...i[t]},e[t]):i[t]=e[t]}return i}function St(i){return{getGroup(e){const t=i[e];return n=>t&&t[n]||n},getRaw(){return i},extend(e,t){if(!e)return this;let n;return t?n=Fe({...e},i):n=Fe({...i},e),St(n)}}}function Nt(i,e,t){const n=i.slice();return n[11]=e[t][0],n[12]=e[t][1],n}function Tt(i,e,t){const n=i.slice();return n[15]=e[t],n}function Ui(i){let e,t,n=i[15].theme+"",l,s,r,a,o;return{c(){e=_("div"),t=_("div"),l=F(n),s=A(),r=_("div"),r.innerHTML='<i class="wxi wxi-close svelte-1aeli9u"></i>',a=A(),m(t,"class","text svelte-1aeli9u"),m(r,"class","remove svelte-1aeli9u"),m(r,"data-action","remove"),m(e,"class","info description svelte-1aeli9u"),m(e,"data-id",o=i[15].id),B(e,"selected",i[15].id===i[1])},m(f,u){k(f,e,u),b(e,t),b(t,l),b(e,s),b(e,r),b(e,a)},p(f,u){u&4&&n!==(n=f[15].theme+"")&&z(l,n),u&4&&o!==(o=f[15].id)&&m(e,"data-id",o),u&6&&B(e,"selected",f[15].id===f[1])},d(f){f&&p(e)}}}function Zi(i){let e,t,n,l,s=i[15].theme+"",r,a,o,f,u,c,d,h=i[5](i[15].agent).name+"",g,v,M;function H(C,R){return R&4&&(u=null),u==null&&(u=!!C[5](C[15].agent).avatar),u?Gi:Ji}let N=H(i,-1),y=N(i);return{c(){e=_("div"),t=_("div"),t.innerHTML='<i class="wxi wxi-close svelte-1aeli9u"></i>',n=A(),l=_("div"),r=F(s),a=A(),o=_("div"),f=_("div"),y.c(),c=A(),d=_("span"),g=F(h),v=A(),m(t,"class","remove svelte-1aeli9u"),m(t,"data-action","remove"),m(l,"class","theme svelte-1aeli9u"),m(f,"class","avatar svelte-1aeli9u"),m(d,"class","name svelte-1aeli9u"),m(o,"class","agent svelte-1aeli9u"),m(e,"class","info theme svelte-1aeli9u"),m(e,"data-id",M=i[15].id),B(e,"selected",i[15].id===i[1])},m(C,R){k(C,e,R),b(e,t),b(e,n),b(e,l),b(l,r),b(e,a),b(e,o),b(o,f),y.m(f,null),b(o,c),b(o,d),b(d,g),b(e,v)},p(C,R){R&4&&s!==(s=C[15].theme+"")&&z(r,s),N===(N=H(C,R))&&y?y.p(C,R):(y.d(1),y=N(C),y&&(y.c(),y.m(f,null))),R&4&&h!==(h=C[5](C[15].agent).name+"")&&z(g,h),R&4&&M!==(M=C[15].id)&&m(e,"data-id",M),R&6&&B(e,"selected",C[15].id===C[1])},d(C){C&&p(e),y.d()}}}function Ji(i){let e,t=i[5](i[15].agent).name[0].toUpperCase()+"",n;return{c(){e=_("div"),n=F(t),m(e,"class","initials svelte-1aeli9u")},m(l,s){k(l,e,s),b(e,n)},p(l,s){s&4&&t!==(t=l[5](l[15].agent).name[0].toUpperCase()+"")&&z(n,t)},d(l){l&&p(e)}}}function Gi(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[5](i[15].agent).avatar)||m(e,"src",t),m(e,"alt","agent's avatar"),m(e,"class","svelte-1aeli9u")},m(n,l){k(n,e,l)},p(n,l){l&4&&!X(e.src,t=n[5](n[15].agent).avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function At(i,e){let t,n;function l(a,o){return a[0].length>1?Zi:Ui}let s=l(e),r=s(e);return{key:i,first:null,c(){t=x(),r.c(),n=x(),this.first=t},m(a,o){k(a,t,o),r.m(a,o),k(a,n,o)},p(a,o){e=a,s===(s=l(e))&&r?r.p(e,o):(r.d(1),r=s(e),r&&(r.c(),r.m(n.parentNode,n)))},d(a){a&&(p(t),p(n)),r.d(a)}}}function Ht(i){let e,t,n=i[11]+"",l,s,r,a=[],o=new Map,f,u=te(i[12]);const c=d=>d[15].id;for(let d=0;d<u.length;d+=1){let h=Tt(i,u,d),g=c(h);o.set(g,a[d]=At(g,h))}return{c(){e=_("div"),t=_("div"),l=F(n),s=A(),r=_("div");for(let d=0;d<a.length;d+=1)a[d].c();f=A(),m(t,"class","date svelte-1aeli9u"),m(r,"class","chats svelte-1aeli9u"),m(e,"class","chats-wrapper")},m(d,h){k(d,e,h),b(e,t),b(t,l),b(e,s),b(e,r);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(r,null);b(e,f)},p(d,h){h&4&&n!==(n=d[11]+"")&&z(l,n),h&39&&(u=te(d[12]),a=qe(a,h,c,1,d,u,o,r,Je,At,null,Tt))},d(d){d&&p(e);for(let h=0;h<a.length;h+=1)a[h].d()}}}function Ki(i){let e,t,n,l=te(Object.entries(i[2])),s=[];for(let r=0;r<l.length;r+=1)s[r]=Ht(Nt(i,l,r));return{c(){e=_("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","container svelte-1aeli9u")},m(r,a){k(r,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t||(n=De(yt.call(null,e,{click:i[3],remove:i[4]})),t=!0)},p(r,[a]){if(a&39){l=te(Object.entries(r[2]));let o;for(o=0;o<l.length;o+=1){const f=Nt(r,l,o);s[o]?s[o].p(f,a):(s[o]=Ht(f),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},i:j,o:j,d(r){r&&p(e),Jt(s,r),t=!1,n()}}}function Qi(i,e,t){let n,{chats:l}=e,{agents:s}=e,{selected:r}=e;const a=je("wx-i18n"),o=Yi("%d %F %Y",a.getRaw().calendar),f=fe();function u(g,v){const M={};return[...g].sort((N,y)=>y.created-N.created).forEach(N=>{const y=Pi(N.created,v);M[y]||(M[y]=[]),M[y].push(N)}),M}function c(g){f("select-chat",{id:g})}function d(g){f("delete-chat",{id:g})}function h(g){return s.find(v=>v.id===g)}return i.$$set=g=>{"chats"in g&&t(6,l=g.chats),"agents"in g&&t(0,s=g.agents),"selected"in g&&t(1,r=g.selected)},i.$$.update=()=>{i.$$.dirty&64&&t(2,n=u(l,o))},[s,r,n,c,d,h,l]}class Xi extends q{constructor(e){super(),I(this,e,Qi,Ki,O,{chats:6,agents:0,selected:1})}}function Dt(i,e,t){const n=i.slice();return n[2]=e[t],n}function xi(i){let e,t=i[2].name[0].toUpperCase()+"",n;return{c(){e=_("div"),n=F(t),m(e,"class","initials svelte-1dkdxjb")},m(l,s){k(l,e,s),b(e,n)},p(l,s){s&1&&t!==(t=l[2].name[0].toUpperCase()+"")&&z(n,t)},d(l){l&&p(e)}}}function $i(i){let e,t;return{c(){e=_("img"),X(e.src,t=i[2].avatar)||m(e,"src",t),m(e,"alt","agent avatar"),m(e,"class","svelte-1dkdxjb")},m(n,l){k(n,e,l)},p(n,l){l&1&&!X(e.src,t=n[2].avatar)&&m(e,"src",t)},d(n){n&&p(e)}}}function Et(i,e){let t,n,l,s,r=e[2].name+"",a,o,f;function u(h,g){return h[2].avatar?$i:xi}let c=u(e),d=c(e);return{key:i,first:null,c(){t=_("div"),n=_("div"),d.c(),l=A(),s=_("span"),a=F(r),o=A(),m(n,"class","avatar svelte-1dkdxjb"),m(s,"class","name svelte-1dkdxjb"),m(t,"class","agent svelte-1dkdxjb"),m(t,"data-id",f=e[2].id),this.first=t},m(h,g){k(h,t,g),b(t,n),d.m(n,null),b(t,l),b(t,s),b(s,a),b(t,o)},p(h,g){e=h,c===(c=u(e))&&d?d.p(e,g):(d.d(1),d=c(e),d&&(d.c(),d.m(n,null))),g&1&&r!==(r=e[2].name+"")&&z(a,r),g&1&&f!==(f=e[2].id)&&m(t,"data-id",f)},d(h){h&&p(t),d.d()}}}function el(i){let e,t,n,l=[],s=new Map,r,a,o,f=te(i[0]);const u=c=>c[2].id;for(let c=0;c<f.length;c+=1){let d=Dt(i,f,c),h=u(d);s.set(h,l[c]=Et(h,d))}return{c(){e=_("div"),t=_("div"),t.innerHTML="<span>Choose agent to begin new chat</span>",n=A();for(let c=0;c<l.length;c+=1)l[c].c();m(t,"class","text svelte-1dkdxjb"),m(e,"class",r="container "+(i[1]?"popup":"modal")+" svelte-1dkdxjb")},m(c,d){k(c,e,d),b(e,t),b(e,n);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(e,null);a||(o=De(yt.call(null,e,{click:i[3]})),a=!0)},p(c,[d]){d&1&&(f=te(c[0]),l=qe(l,d,u,1,c,f,s,e,Je,Et,null,Dt)),d&2&&r!==(r="container "+(c[1]?"popup":"modal")+" svelte-1dkdxjb")&&m(e,"class",r)},i:j,o:j,d(c){c&&p(e);for(let d=0;d<l.length;d+=1)l[d].d();a=!1,o()}}}function tl(i,e,t){let{agents:n}=e,{popup:l=!0}=e;const s=fe();let r;function a(o){t(2,r=o),s("agent-select",{agent:r})}return i.$$set=o=>{"agents"in o&&t(0,n=o.agents),"popup"in o&&t(1,l=o.popup)},[n,l,r,a]}class jt extends q{constructor(e){super(),I(this,e,tl,el,O,{agents:0,popup:1})}}function nl(i){let e;return{c(){e=_("div"),e.innerHTML='<i class="wxi-plus svelte-1q8b3it"></i><span>New Chat</span>',m(e,"class","icon svelte-1q8b3it")},m(t,n){k(t,e,n)},p:j,d(t){t&&p(e)}}}function Ot(i){let e,t;return e=new Xi({props:{chats:i[0],agents:i[1],selected:i[2]}}),e.$on("select-chat",i[8]),e.$on("delete-chat",i[9]),e.$on("select-chat",i[14]),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.chats=n[0]),l&2&&(s.agents=n[1]),l&4&&(s.selected=n[2]),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Lt(i){let e,t;return e=new pi({props:{$$slots:{default:[ll]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&65554&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function il(i){let e,t,n;return t=new jt({props:{agents:i[1]}}),t.$on("agent-select",i[7]),{c(){e=_("div"),L(t.$$.fragment),m(e,"class","popup-container svelte-1q8b3it")},m(l,s){k(l,e,s),D(t,e,null),n=!0},p(l,s){const r={};s&2&&(r.agents=l[1]),t.$set(r)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){S(t.$$.fragment,l),n=!1},d(l){l&&p(e),E(t)}}}function ll(i){let e,t;return e=new gi({props:{area:i[4],cancel:i[6],$$slots:{default:[il]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&16&&(s.area=n[4]),l&65538&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function sl(i){let e,t,n,l,s,r,a;n=new ht({props:{click:i[5],type:"primary block",$$slots:{default:[nl]},$$scope:{ctx:i}}});let o=i[0].length&&Ot(i),f=i[1].length>1&&i[4]&&Lt(i);return{c(){e=_("div"),t=_("div"),L(n.$$.fragment),l=A(),o&&o.c(),s=A(),f&&f.c(),r=x(),m(t,"class","button-container svelte-1q8b3it"),m(e,"class","sidebar svelte-1q8b3it")},m(u,c){k(u,e,c),b(e,t),D(n,t,null),i[13](t),b(e,l),o&&o.m(e,null),k(u,s,c),f&&f.m(u,c),k(u,r,c),a=!0},p(u,[c]){const d={};c&65536&&(d.$$scope={dirty:c,ctx:u}),n.$set(d),u[0].length?o?(o.p(u,c),c&1&&w(o,1)):(o=Ot(u),o.c(),w(o,1),o.m(e,null)):o&&(J(),S(o,1,1,()=>{o=null}),G()),u[1].length>1&&u[4]?f?(f.p(u,c),c&18&&w(f,1)):(f=Lt(u),f.c(),w(f,1),f.m(r.parentNode,r)):f&&(J(),S(f,1,1,()=>{f=null}),G())},i(u){a||(w(n.$$.fragment,u),w(o),w(f),a=!0)},o(u){S(n.$$.fragment,u),S(o),S(f),a=!1},d(u){u&&(p(e),p(s),p(r)),E(n),i[13](null),o&&o.d(),f&&f.d(u)}}}function rl(i,e,t){let{chats:n}=e,{agents:l}=e,{bus:s}=e,{agentId:r}=e,{activeChat:a}=e,{narrowMode:o}=e,f,u;const c=fe();function d(){if(o)c("show-agents");else if(l.length>1){const{top:y,height:C,left:R}=f.getBoundingClientRect();t(4,u={top:y+10,height:C,left:R+12})}else s.exec("select-chat",{id:null,agent:l[0].id})}function h(){t(4,u=null)}function g(y){t(10,r=y.detail.agent),s.exec("select-chat",{id:null,agent:r}),h()}function v(y){const C=y.detail.id;s.exec("select-chat",{id:C})}function M(y){const C=y.detail.id;s.exec("delete-chat",{id:C})}function H(y){ee[y?"unshift":"push"](()=>{f=y,t(3,f)})}function N(y){tn.call(this,i,y)}return i.$$set=y=>{"chats"in y&&t(0,n=y.chats),"agents"in y&&t(1,l=y.agents),"bus"in y&&t(11,s=y.bus),"agentId"in y&&t(10,r=y.agentId),"activeChat"in y&&t(2,a=y.activeChat),"narrowMode"in y&&t(12,o=y.narrowMode)},[n,l,a,f,u,d,h,g,v,M,r,s,o,H,N]}class It extends q{constructor(e){super(),I(this,e,rl,sl,O,{chats:0,agents:1,bus:11,agentId:10,activeChat:2,narrowMode:12})}}function qt(i){let e,t,n;return{c(){e=_("div"),e.innerHTML='<i class="wxi-menu"></i>',m(e,"class","icon svelte-1h50gh9")},m(l,s){k(l,e,s),t||(n=ie(e,"click",function(){ke(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,s){i=l},d(l){l&&p(e),t=!1,n()}}}function al(i){let e,t,n,l,s,r=i[1]?" with "+i[1]:"",a,o,f,u,c=i[0]&&qt(i);const d=i[3].default,h=W(d,i,i[2],null);return{c(){e=_("div"),t=_("div"),c&&c.c(),n=A(),l=_("div"),s=F("ChatBot"),a=F(r),o=A(),f=_("div"),h&&h.c(),m(l,"class","text svelte-1h50gh9"),m(t,"class","header svelte-1h50gh9"),m(f,"class","wrapper svelte-1h50gh9"),m(e,"class","narrow svelte-1h50gh9")},m(g,v){k(g,e,v),b(e,t),c&&c.m(t,null),b(t,n),b(t,l),b(l,s),b(l,a),b(e,o),b(e,f),h&&h.m(f,null),u=!0},p(g,[v]){g[0]?c?c.p(g,v):(c=qt(g),c.c(),c.m(t,n)):c&&(c.d(1),c=null),(!u||v&2)&&r!==(r=g[1]?" with "+g[1]:"")&&z(a,r),h&&h.p&&(!u||v&4)&&U(h,d,g,g[2],u?Y(d,g[2],v,null):Z(g[2]),null)},i(g){u||(w(h,g),u=!0)},o(g){S(h,g),u=!1},d(g){g&&p(e),c&&c.d(),h&&h.d(g)}}}function ol(i,e,t){let{$$slots:n={},$$scope:l}=e,{back:s=!1}=e,{agentName:r=null}=e;return i.$$set=a=>{"back"in a&&t(0,s=a.back),"agentName"in a&&t(1,r=a.agentName),"$$scope"in a&&t(2,l=a.$$scope)},[s,r,l,n]}class fl extends q{constructor(e){super(),I(this,e,ol,al,O,{back:0,agentName:1})}}function cl(i){let e,t,n,l,s,r,a,o=i[9]!==!1&&Pt(i),f=i[9]!==!1&&Ft(i);return r=new wt({props:{data:i[10],$user:i[11],render:i[12],readonly:i[13],format:i[14],store:i[1],agent:i[7]}}),{c(){o&&o.c(),e=A(),t=_("div"),f&&f.c(),n=A(),l=_("div"),s=_("div"),L(r.$$.fragment),m(s,"class","wrapper svelte-13ctwha"),m(l,"class","panel svelte-13ctwha"),m(t,"class","right svelte-13ctwha")},m(u,c){o&&o.m(u,c),k(u,e,c),k(u,t,c),f&&f.m(t,null),b(t,n),b(t,l),b(l,s),D(r,s,null),i[32](s),a=!0},p(u,c){u[9]!==!1?o?(o.p(u,c),c[0]&512&&w(o,1)):(o=Pt(u),o.c(),w(o,1),o.m(e.parentNode,e)):o&&(J(),S(o,1,1,()=>{o=null}),G()),u[9]!==!1?f?f.p(u,c):(f=Ft(u),f.c(),f.m(t,n)):f&&(f.d(1),f=null);const d={};c[0]&1024&&(d.data=u[10]),c[0]&2048&&(d.$user=u[11]),c[0]&4096&&(d.render=u[12]),c[0]&8192&&(d.readonly=u[13]),c[0]&16384&&(d.format=u[14]),c[0]&2&&(d.store=u[1]),c[0]&128&&(d.agent=u[7]),r.$set(d)},i(u){a||(w(o),w(r.$$.fragment,u),a=!0)},o(u){S(o),S(r.$$.fragment,u),a=!1},d(u){u&&(p(e),p(t)),o&&o.d(u),f&&f.d(),E(r),i[32](null)}}}function ul(i){let e,t;return e=new fl({props:{back:i[29](i[6],i[5]),agentName:!i[5]&&!i[6]?i[7]?.name:null,$$slots:{default:[ml]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l[0]&96&&(s.back=n[29](n[6],n[5])),l[0]&224&&(s.agentName=!n[5]&&!n[6]?n[7]?.name:null),l[0]&32255|l[1]&16&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Pt(i){let e,t,n;return t=new It({props:{chats:i[8],agents:i[3],bus:i[1].in,activeChat:i[4]}}),{c(){e=_("div"),L(t.$$.fragment),m(e,"class","left svelte-13ctwha"),B(e,"visible",i[5])},m(l,s){k(l,e,s),D(t,e,null),n=!0},p(l,s){const r={};s[0]&256&&(r.chats=l[8]),s[0]&8&&(r.agents=l[3]),s[0]&2&&(r.bus=l[1].in),s[0]&16&&(r.activeChat=l[4]),t.$set(r),(!n||s[0]&32)&&B(e,"visible",l[5])},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){S(t.$$.fragment,l),n=!1},d(l){l&&p(e),E(t)}}}function Ft(i){let e,t,n,l,s;return{c(){e=_("div"),t=_("i"),m(t,"class",n="wxi-angle-"+(i[5]?"left":"right")+" svelte-13ctwha"),m(e,"class","button svelte-13ctwha"),B(e,"round",!i[5])},m(r,a){k(r,e,a),b(e,t),l||(s=ie(e,"click",i[26]),l=!0)},p(r,a){a[0]&32&&n!==(n="wxi-angle-"+(r[5]?"left":"right")+" svelte-13ctwha")&&m(t,"class",n),a[0]&32&&B(e,"round",!r[5])},d(r){r&&p(e),l=!1,s()}}}function dl(i){let e,t,n;return t=new wt({props:{data:i[10],$user:i[11],render:i[12],readonly:i[13],format:i[14],store:i[1],agent:i[7]}}),{c(){e=_("div"),L(t.$$.fragment),m(e,"class","wrapper svelte-13ctwha")},m(l,s){k(l,e,s),D(t,e,null),i[31](e),n=!0},p(l,s){const r={};s[0]&1024&&(r.data=l[10]),s[0]&2048&&(r.$user=l[11]),s[0]&4096&&(r.render=l[12]),s[0]&8192&&(r.readonly=l[13]),s[0]&16384&&(r.format=l[14]),s[0]&2&&(r.store=l[1]),s[0]&128&&(r.agent=l[7]),t.$set(r)},i(l){n||(w(t.$$.fragment,l),n=!0)},o(l){S(t.$$.fragment,l),n=!1},d(l){l&&p(e),E(t),i[31](null)}}}function hl(i){let e,t;return e=new jt({props:{agents:i[3],popup:!1}}),e.$on("agent-select",i[28]),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l[0]&8&&(s.agents=n[3]),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function gl(i){let e,t;return e=new It({props:{chats:i[8],agents:i[3],bus:i[1].in,activeChat:i[4],narrowMode:i[0]}}),e.$on("show-agents",i[27]),e.$on("select-chat",i[26]),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l[0]&256&&(s.chats=n[8]),l[0]&8&&(s.agents=n[3]),l[0]&2&&(s.bus=n[1].in),l[0]&16&&(s.activeChat=n[4]),l[0]&1&&(s.narrowMode=n[0]),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function ml(i){let e,t,n,l;const s=[gl,hl,dl],r=[];function a(o,f){return o[5]?0:o[6]?1:2}return e=a(i),t=r[e]=s[e](i),{c(){t.c(),n=x()},m(o,f){r[e].m(o,f),k(o,n,f),l=!0},p(o,f){let u=e;e=a(o),e===u?r[e].p(o,f):(J(),S(r[u],1,1,()=>{r[u]=null}),G(),t=r[e],t?t.p(o,f):(t=r[e]=s[e](o),t.c()),w(t,1),t.m(n.parentNode,n))},i(o){l||(w(t),l=!0)},o(o){S(t),l=!1},d(o){o&&p(n),r[e].d(o)}}}function _l(i){let e,t,n,l,s,r,a;const o=[ul,cl],f=[];function u(c,d){return c[0]&&c[9]!==!1?0:1}return n=u(i),l=f[n]=o[n](i),{c(){e=_("div"),t=_("div"),l.c(),m(t,"class","chat-wrapper svelte-13ctwha"),m(e,"class","layout svelte-13ctwha")},m(c,d){k(c,e,d),b(e,t),f[n].m(t,null),s=!0,r||(a=De(i[25].call(null,e)),r=!0)},p(c,d){let h=n;n=u(c),n===h?f[n].p(c,d):(J(),S(f[h],1,1,()=>{f[h]=null}),G(),l=f[n],l?l.p(c,d):(l=f[n]=o[n](c),l.c()),w(l,1),l.m(t,null))},i(c){s||(w(l),s=!0)},o(c){S(l),s=!1},d(c){c&&p(e),f[n].d(),r=!1,a()}}}function bl(i){if(i){const e=i.querySelector("[data-focus] textarea");e&&e.focus()}}function vl(i,e,t){let n,l,s,r,a,o,f,u,c,d,h,{store:g}=e,{narrowMode:v}=e;const{messages:M,agents:H,chats:N,user:y,activeChat:C,activeAgent:R,sidebar:he,readonly:P,render:K,format:Q}=g.getReactive();$(i,M,T=>t(10,f=T)),$(i,H,T=>t(3,s=T)),$(i,N,T=>t(8,l=T)),$(i,y,T=>t(11,u=T)),$(i,C,T=>t(4,r=T)),$(i,R,T=>t(30,a=T)),$(i,he,T=>t(9,o=T)),$(i,P,T=>t(13,d=T)),$(i,K,T=>t(12,c=T)),$(i,Q,T=>t(14,h=T));function ge(T){new ResizeObserver(Gl=>{const Re=Gl[0].borderBoxSize[0].inlineSize<768;Re!==v&&zl(Re),t(0,v=Re)}).observe(T)}function zl(T){t(5,se=!T),t(6,_e=!1)}let me,[se,_e]=Vl();function Vl(){return v?r?[!1,!1]:[!!l.length,!l.length&&s.length>1]:[!0,!1]}function Wt(){if(v)if(!l.length&&s.length>1){t(6,_e=!0);return}else t(6,_e=!1);t(5,se=!se)}function Wl(){t(5,se=!se),t(6,_e=s.length>1)}function Yl(T){const He=T.detail.agent;g.in.exec("select-chat",{id:null,agent:He}),t(5,se=t(6,_e=!1))}function Ul(T,He){return T&&!l.length?!1:He?null:Wt}function Zl(T){ee[T?"unshift":"push"](()=>{me=T,t(2,me)})}function Jl(T){ee[T?"unshift":"push"](()=>{me=T,t(2,me)})}return i.$$set=T=>{"store"in T&&t(1,g=T.store),"narrowMode"in T&&t(0,v=T.narrowMode)},i.$$.update=()=>{i.$$.dirty[0]&1073741832&&t(7,n=a?s.find(T=>T.id===a):null),i.$$.dirty[0]&1073741844&&bl(me)},[v,g,me,s,r,se,_e,n,l,o,f,u,c,d,h,M,H,N,y,C,R,he,P,K,Q,ge,Wt,Wl,Yl,Ul,a,Zl,Jl]}class pl extends q{constructor(e){super(),I(this,e,vl,_l,O,{store:1,narrowMode:0},null,[-1,-1])}}function Rt(i){let e,t;return e=new pl({props:{store:i[0],narrowMode:i[2]}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.store=n[0]),l&4&&(s.narrowMode=n[2]),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function wl(i){let e,t,n,l=typeof i[2]=="boolean"&&Rt(i);return{c(){e=_("div"),l&&l.c(),m(e,"class","wrapper svelte-sm3lir"),Ne(()=>i[3].call(e))},m(s,r){k(s,e,r),l&&l.m(e,null),t=Xt(e,i[3].bind(e)),n=!0},p(s,[r]){typeof s[2]=="boolean"?l?(l.p(s,r),r&4&&w(l,1)):(l=Rt(s),l.c(),w(l,1),l.m(e,null)):l&&(J(),S(l,1,1,()=>{l=null}),G())},i(s){n||(w(l),n=!0)},o(s){S(l),n=!1},d(s){s&&p(e),l&&l.d(),t()}}}function kl(i,e,t){let{store:n}=e,l,s;Ee(()=>{t(2,s=l<768)});function r(){l=this.clientWidth,t(1,l)}return i.$$set=a=>{"store"in a&&t(0,n=a.store)},[n,l,s,r]}class yl extends q{constructor(e){super(),I(this,e,kl,wl,O,{store:0})}}let Ml=new Date().valueOf();function Ae(){return"temp://"+Ml++}const Bt=2;class Cl{constructor(e){e&&(this._writable=e.writable,this._async=e.async),this._values={},this._state={}}setState(e,t=0){const n={};return this._wrapProperties(e,this._state,this._values,"",n,t),n}getState(){return this._values}getReactive(){return this._state}_wrapProperties(e,t,n,l,s,r){for(const a in e){const o=t[a],f=n[a],u=e[a];if(o&&(f===u&&typeof u!="object"||u instanceof Date&&f instanceof Date&&f.getTime()===u.getTime()))continue;const c=l+(l?".":"")+a;o?(o.__parse(u,c,s,r)&&(n[a]=u),r&Bt?s[c]=o.__trigger:o.__trigger()):(u&&u.__reactive?t[a]=this._wrapNested(u,u,c,s):t[a]=this._wrapWritable(u),n[a]=u),s[c]=s[c]||null}}_wrapNested(e,t,n,l){const s=this._wrapWritable(e);return this._wrapProperties(e,s,t,n,l,0),s.__parse=(r,a,o,f)=>(this._wrapProperties(r,s,t,a,o,f),!1),s}_wrapWritable(e){const t=[],n=function(){for(let l=0;l<t.length;l++)t[l](e)};return{subscribe:l=>(t.push(l),this._async?setTimeout(l,1,e):l(e),()=>{const s=t.indexOf(l);s>=0&&t.splice(s,1)}),__trigger:()=>{t.length&&(this._async?setTimeout(n,1):n())},__parse:function(l){return e=l,!0}}}}class Sl{constructor(e,t,n,l){typeof e=="function"?this._setter=e:this._setter=e.setState.bind(e),this._routes=t,this._parsers=n,this._prev={},this._triggers=new Map,this._sources=new Map,this._routes.forEach(s=>{s.in.forEach(r=>{const a=this._triggers.get(r)||[];a.push(s),this._triggers.set(r,a)}),s.out.forEach(r=>{const a=this._sources.get(r)||{};s.in.forEach(o=>a[o]=!0),this._sources.set(r,a)})}),this._routes.forEach(s=>{s.length=Math.max(...s.in.map(r=>zt(r,this._sources,1)))}),this._bus=l}init(e){const t={};for(const n in e)if(this._prev[n]!==e[n]){const l=this._parsers[n];t[n]=l?l(e[n]):e[n]}this._prev=this._prev?{...this._prev,...e}:{...e},this.setState(t),this._bus&&this._bus.exec("init-state",t)}setStateAsync(e){const t=this._setter(e,Bt);return this._async?Object.assign(this._async.signals,t):this._async={signals:t,timer:setTimeout(this._applyState.bind(this),1)},t}_applyState(){const e=this._async;if(e){this._async=null,this._triggerUpdates(e.signals,[]);for(const t in e.signals){const n=e.signals[t];n&&n()}}}setState(e,t=[]){const n=this._setter(e);return this._triggerUpdates(n,t),n}_triggerUpdates(e,t){const n=Object.keys(e),l=!t.length;t=t||[];for(let s=0;s<n.length;s++){const r=n[s],a=this._triggers.get(r);a&&a.forEach(o=>{t.indexOf(o)==-1&&t.push(o)})}l&&this._execNext(t)}_execNext(e){for(;e.length;){e.sort((n,l)=>n.length<l.length?1:-1);const t=e[e.length-1];e.splice(e.length-1),t.exec(e)}}}function zt(i,e,t){const n=e.get(i);if(!n)return t;const l=Object.keys(n).map(s=>zt(s,e,t+1));return Math.max(...l)}class Nl{constructor(){this._nextHandler=null,this._handlers={},this._tag=new WeakMap,this.exec=this.exec.bind(this)}on(e,t,n){let l=this._handlers[e];l?n&&n.intercept?l.unshift(t):l.push(t):l=this._handlers[e]=[t],n&&n.tag&&this._tag.set(t,n.tag)}intercept(e,t,n){this.on(e,t,{...n,intercept:!0})}detach(e){for(const t in this._handlers){const n=this._handlers[t];for(let l=n.length-1;l>=0;l--)this._tag.get(n[l])===e&&n.splice(l,1)}}async exec(e,t){const n=this._handlers[e];if(n)for(let l=0;l<n.length;l++){const s=n[l](t);if(s===!1||s&&s.then&&await s===!1)return}return this._nextHandler&&await this._nextHandler.exec(e,t),t}setNext(e){return this._nextHandler=e}}class Tl extends Cl{in;_router;_cache;constructor(e){super(e),this._router=new Sl(super.setState.bind(this),[{in:["messages"],out:[],exec:()=>{const{activeChat:n,withCache:l,messages:s}=this.getState();l&&n&&this._cache.set(n,[...s])}}],{});const t=this.in=new Nl;this.initOnce(),t.on("select-chat",({id:n,agent:l})=>{const{activeChat:s,withCache:r}=this.getState();if(n&&!l){const a=this.getState().chats.find(o=>o.id===n);l=a?a.agent:0}if(this.setState({activeChat:n,activeAgent:l||0}),n){if(s===n)return;const a=r?this._cache.get(n):null;a?(a.forEach(o=>o.typing=0),this.setState({messages:a})):t.exec("request-messages",{id:n})}else this.setState({messages:[]})}),t.on("provide-messages",({id:n,data:l})=>{const{activeChat:s,user:r,agents:a,withCache:o}=this.getState(),f=l.map(u=>this._correctMessages(u,r,a));s!==n?o&&this._cache.set(n,l):this.setState({messages:f})}),t.on("append-message",({id:n,content:l})=>{const{messages:s,agents:r}=this.getState(),a=s.findIndex(o=>o.id===n);if(a===-1)s.push({id:n,content:l,author:r[0],role:"agent",typing:1});else{const o={...s[a]};o.content+=l,s[a]=o}this.setState({messages:s})}),t.on("type-message",({id:n,mode:l})=>{const{messages:s}=this.getState(),r=s.findIndex(o=>o.id===n);if(r===-1)return;const a={...s[r],typing:l};s[r]=a,this.setState({messages:s})}),t.on("add-message",({id:n,message:l})=>{const{chats:s,user:r,agents:a,messages:o,activeChat:f,activeAgent:u}=this.getState(),c=s.find(h=>h.id===n),d=c?a.find(h=>h.id===c.agent):null;if(l.id=l.id||Ae(),l.role=l.role||"user",l.author||(l.role==="user"?l.author=r:l.author=d),f===n||!f&&!n){let h=[...o,l];this.setState({messages:h}),d&&d.response&&d.response(h).then(g=>{if(g){let v=[...this.getState().messages,{id:Ae(),role:"agent",author:d,...g}];this.setState({messages:v})}})}}),t.on("delete-chat",({id:n})=>{const{activeChat:l,chats:s}=this.getState();l===n&&this.setState({activeChat:null}),this._cache.delete(n),this.setState({chats:s.filter(r=>r.id!==n)})}),t.on("add-chat",({chat:n,convert:l})=>{const{activeChat:s,chats:r}=this.getState();n.id=n.id||Ae(),n.theme=n.theme||"New chat",n.created=n.created||new Date;const a={chats:[...r,n]};!s&&l&&(a.activeChat=n.id),this.setState(a)})}_correctMessages(e,t,n){return e.role==="user"?e.author=t:typeof e.author!="object"&&(e.author=n.find(l=>l.id===e.author)),e}_addChat(e,t){const{agents:n}=this.getState(),l=n[0],s={id:Ae(),agent:l.id,theme:t.content.split(" ",4).slice(0,3).join(" ").substring(0,30),created:new Date};return{chats:[...e,s],activeChat:s.id}}initOnce(){const e={};this._router.init(e),this._cache=new Map}init(e){const t=this.getState();if(!t.activeAgent&&!e.activeAgent){let l=e.agents?e.agents[0]:null;!l&&t.agents&&(l=t.agents[0]),l&&(e.activeAgent=l.id)}e.messages?.length&&!t.activeChat&&!e.activeChat&&(e.activeChat=1,e.chats=[{id:1,theme:"New chat",created:new Date,agent:e.activeAgent}]);const n={activeChat:null,activeAgent:0,messages:[],...e};this._router.init(n)}setState(e,t){return this._router.setState(e,t)}}const Al={chatbot:{}};function Hl(i){let e,t;return e=new yl({props:{store:i[0]}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p:j,i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Dl(i){let e,t;return e=new Ai({props:{words:Al,optional:!0,$$slots:{default:[Hl]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,[l]){const s={};l&131072&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function El(i,e,t){let{chats:n=[]}=e,{activeChat:l=null}=e,{init:s=null}=e,{withCache:r=!1}=e,{sidebar:a=!0}=e,{readonly:o=!1}=e,{messages:f=[]}=e,{agents:u=[{id:0,name:"Agent",avatar:"https://img.freepik.com/premium-vector/avatar-icon002_750950-52.jpg"}]}=e,{activeAgent:c=l?n.find(C=>C.id===l)?.agent:u.length?u[0].id:0}=e,{user:d={id:-1,name:"Me"}}=e,{render:h="blocks"}=e,{format:g="text"}=e;const v=new Tl,M=fe();let H=new Li(M),N=v.in;N.setNext(H);const y={getState:v.getState.bind(v),getReactiveState:v.getReactive.bind(v),getStores:()=>({data:v}),exec:N.exec,setNext:C=>H=H.setNext(C),intercept:N.intercept.bind(N),on:N.on.bind(N),detach:N.detach.bind(N),getFile:C=>v.getFile(C),serialize:C=>v.serialize(C)};return i.$$set=C=>{"chats"in C&&t(2,n=C.chats),"activeChat"in C&&t(3,l=C.activeChat),"init"in C&&t(1,s=C.init),"withCache"in C&&t(4,r=C.withCache),"sidebar"in C&&t(5,a=C.sidebar),"readonly"in C&&t(6,o=C.readonly),"messages"in C&&t(7,f=C.messages),"agents"in C&&t(8,u=C.agents),"activeAgent"in C&&t(9,c=C.activeAgent),"user"in C&&t(10,d=C.user),"render"in C&&t(11,h=C.render),"format"in C&&t(12,g=C.format)},i.$$.update=()=>{i.$$.dirty&8190&&(v.init({agents:u,chats:n,user:d,activeChat:l,activeAgent:c,withCache:r,messages:f,readonly:o,sidebar:a,format:g,render:h}),s&&(s(y),t(1,s=null)))},[v,s,n,l,r,a,o,f,u,c,d,h,g,y]}class jl extends q{constructor(e){super(),I(this,e,El,Dl,O,{chats:2,activeChat:3,init:1,withCache:4,sidebar:5,readonly:6,messages:7,agents:8,activeAgent:9,user:10,render:11,format:12,api:13})}get api(){return this.$$.ctx[13]}}function Ol(i){let e,t;return e=new _t({props:{fonts:i[0]}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.fonts=n[0]),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Ll(i){let e,t;return e=new _t({props:{fonts:i[0],$$slots:{default:[Il]},$$scope:{ctx:i}}}),{c(){L(e.$$.fragment)},m(n,l){D(e,n,l),t=!0},p(n,l){const s={};l&1&&(s.fonts=n[0]),l&8&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){S(e.$$.fragment,n),t=!1},d(n){E(e,n)}}}function Il(i){let e;const t=i[2].default,n=W(t,i,i[3],null);return{c(){n&&n.c()},m(l,s){n&&n.m(l,s),e=!0},p(l,s){n&&n.p&&(!e||s&8)&&U(n,t,l,l[3],e?Y(t,l[3],s,null):Z(l[3]),null)},i(l){e||(w(n,l),e=!0)},o(l){S(n,l),e=!1},d(l){n&&n.d(l)}}}function ql(i){let e,t,n,l;const s=[Ll,Ol],r=[];function a(o,f){return o[1]&&o[1].default?0:1}return e=a(i),t=r[e]=s[e](i),{c(){t.c(),n=x()},m(o,f){r[e].m(o,f),k(o,n,f),l=!0},p(o,[f]){t.p(o,f)},i(o){l||(w(t),l=!0)},o(o){S(t),l=!1},d(o){o&&p(n),r[e].d(o)}}}function Pl(i,e,t){let{$$slots:n={},$$scope:l}=e;const s=e.$$slots;let{fonts:r=!0}=e;return i.$$set=a=>{t(4,e=ne(ne({},e),ae(a))),"fonts"in a&&t(0,r=a.fonts),"$$scope"in a&&t(3,l=a.$$scope)},e=ae(e),[r,s,n,l]}class Fl extends q{constructor(e){super(),I(this,e,Pl,ql,O,{fonts:0})}}function Rl(i,e,t){const n=document.createElement("DIV");n.className="wx-theme",i.appendChild(n);let l=window.getComputedStyle(n).getPropertyValue("--wx-theme-name");return i.removeChild(n),(e&&e!==l||!e&&!l&&t)&&(l&&i.classList.remove(`wx-${l}-theme`),l=e||t,i.classList.add(`wx-${l}-theme`)),l}const Vt={material:Fl};class Bl{api;config;container;_chat;constructor(e,t){this.container=typeof e=="string"?document.querySelector(e):e,this.config=t,this._init()}destructor(){this._chat.$destroy(),this._chat=this.api=null}on(e,t){this.api.on(e,t)}intercept(e,t){this.api.intercept(e,t)}setConfig(e){this.api.getStores().data.init(e)}getConfig(){return this.api.getState()}setLocale(e){this._setContext({locale:e})}setTheme(e){this._setContext({theme:e})}_setContext(e){this.config={...this.config,...this.api.getState(),...e},this._init()}addMessage(e){this.api.exec("add-message",e)}appendMessage(e){this.api.exec("append-message",e)}typeMessage(e){this.api.exec("type-message",e)}deleteChat(e){this.api.exec("delete-chat",e)}addChat(e){this.api.exec("add-chat",e)}selectChat(e){this.api.exec("select-chat",e)}requestMessages(e){this.api.exec("request-messages",e)}parse(e,t){this.api.exec("provide-messages",{id:e,data:t})}_init(){this._chat&&this.destructor();const e=Rl(this.container,this.config.theme?.name,"material");Vt[e]&&new Vt[e]({target:this.container,props:{fonts:this.config.theme?.fonts}});const t={target:this.container,props:this.config,context:new Map([["wx-theme",e]])};this.config.locale&&t.context.set("wx-i18n",St(this.config.locale)),this._chat=new jl(t),this.api=this._chat.api}}return we.ChatBot=Bl,we.tempID=Oi,Object.defineProperty(we,Symbol.toStringTag,{value:"Module"}),we}({});
